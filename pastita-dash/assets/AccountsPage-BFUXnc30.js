import{j as a}from"./vendor-charts-o9Lo7m6Z.js";import{e as w,r as d}from"./vendor-react-C2HNIXra.js";import{U as n,R as t,Z as o,$ as N,a0 as _,X as c,a6 as b,a4 as E,a7 as S,a8 as z,a9 as D,p as P,aa as M}from"./feature-automation-CLWK1V5x.js";import{u as R}from"./index-DQDVHdIA.js";import{g as T}from"./vendor-utils-DaXQUBrP.js";import"./vendor-ui-B9rDAafI.js";import"./vendor-mui-DKuE-Kg_.js";const U=()=>{const l=w(),{accounts:u,setAccounts:x,setLoading:m,isLoading:h,updateAccount:g,removeAccount:y}=R(),[r,i]=d.useState({isOpen:!1,account:null}),[f,p]=d.useState(!1);d.useEffect(()=>{j()},[]);const j=async()=>{m(!0);try{const e=await n.getAccounts();x(e.results)}catch(e){t.error(o(e))}finally{m(!1)}},v=async e=>{try{const s=e.status==="active"?await n.deactivateAccount(e.id):await n.activateAccount(e.id);g(s),t.success(`Conta ${s.status==="active"?"ativada":"desativada"} com sucesso!`)}catch(s){t.error(o(s))}},k=async e=>{try{const s=await n.syncTemplates(e.id);t.success(s.message)}catch(s){t.error(o(s))}},A=async()=>{if(r.account){p(!0);try{await n.deleteAccount(r.account.id),y(r.account.id),t.success("Conta removida com sucesso!"),i({isOpen:!1,account:null})}catch(e){t.error(o(e))}finally{p(!1)}}},C=[{key:"name",header:"Nome",render:e=>a.jsxs("div",{children:[a.jsx("p",{className:"font-medium text-gray-900 dark:text-white",children:e.name}),a.jsx("p",{className:"text-sm text-gray-500 dark:text-zinc-400",children:e.display_phone_number||e.phone_number})]})},{key:"phone_number_id",header:"Phone Number ID",render:e=>a.jsx("span",{className:"text-sm font-mono text-gray-600 dark:text-zinc-400",children:e.phone_number_id})},{key:"status",header:"Status",render:e=>a.jsx(D,{status:e.status})},{key:"auto_response",header:"Resposta Auto",render:e=>a.jsx("span",{className:`text-sm ${e.auto_response_enabled?"text-green-600":"text-gray-400"}`,children:e.auto_response_enabled?"Ativada":"Desativada"})},{key:"created_at",header:"Criado em",render:e=>a.jsx("span",{className:"text-sm text-gray-600 dark:text-zinc-400",children:T(new Date(e.created_at),"dd/MM/yyyy",{locale:P})})},{key:"actions",header:"Ações",render:e=>a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(c,{size:"sm",variant:"ghost",onClick:s=>{s.stopPropagation(),v(e)},children:e.status==="active"?"Desativar":"Ativar"}),a.jsx(c,{size:"sm",variant:"ghost",onClick:s=>{s.stopPropagation(),k(e)},leftIcon:a.jsx(M,{className:"w-4 h-4"}),children:"Sync"}),a.jsx(c,{size:"sm",variant:"danger",onClick:s=>{s.stopPropagation(),i({isOpen:!0,account:e})},children:"Excluir"})]})}];return h?a.jsx(N,{}):a.jsxs("div",{className:"p-6",children:[a.jsx(_,{title:"Contas WhatsApp",subtitle:`${u.length} conta(s) cadastrada(s)`,actions:a.jsx(c,{leftIcon:a.jsx(b,{className:"w-5 h-5"}),onClick:()=>l("/accounts/new"),children:"Nova Conta"})}),a.jsx(E,{noPadding:!0,children:a.jsx(S,{columns:C,data:u,keyExtractor:e=>e.id,onRowClick:e=>l(`/accounts/${e.id}`),emptyMessage:"Nenhuma conta cadastrada"})}),a.jsx(z,{isOpen:r.isOpen,onClose:()=>i({isOpen:!1,account:null}),onConfirm:A,title:"Excluir Conta",message:`Tem certeza que deseja excluir a conta "${r.account?.name}"? Esta ação não pode ser desfeita.`,confirmText:"Excluir",isLoading:f})]})};export{U as AccountsPage};
