import{j as e}from"./vendor-charts-o9Lo7m6Z.js";import{r as o,e as me,u as ue}from"./vendor-react-C2HNIXra.js";import{d as ge,b2 as v,l as q,R as b,aU as pe,X as w,a5 as he,aa as be,a6 as Y,a4 as h,E as ee,f as ye,aB as je,b3 as Q,ah as re,b4 as $,aN as te,aX as ae,aO as se,b5 as le,h as fe,b1 as M}from"./feature-automation-CLWK1V5x.js";import"./index-DQDVHdIA.js";import"./vendor-utils-DaXQUBrP.js";import"./vendor-ui-B9rDAafI.js";import"./vendor-mui-DKuE-Kg_.js";function ve({title:t,titleId:x,...i},m){return o.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:m,"aria-labelledby":x},i),t?o.createElement("title",{id:x},t):null,o.createElement("path",{fillRule:"evenodd",d:"M10.788 3.21c.448-1.077 1.976-1.077 2.424 0l2.082 5.006 5.404.434c1.164.093 1.636 1.545.749 2.305l-4.117 3.527 1.257 5.273c.271 1.136-.964 2.033-1.96 1.425L12 18.354 7.373 21.18c-.996.608-2.231-.29-1.96-1.425l1.257-5.273-4.117-3.527c-.887-.76-.415-2.212.749-2.305l5.404-.434 2.082-5.005Z",clipRule:"evenodd"}))}const ie=o.forwardRef(ve),B=t=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(t),ce=({quantity:t,threshold:x=5})=>t<=0?e.jsx(M,{variant:"danger",children:"Sem estoque"}):t<=x?e.jsxs(M,{variant:"warning",children:["Estoque baixo (",t,")"]}):e.jsxs(M,{variant:"success",children:[t," em estoque"]}),ne=({status:t})=>{const x={active:"success",inactive:"gray",out_of_stock:"danger",discontinued:"warning"},i={active:"Ativo",inactive:"Inativo",out_of_stock:"Sem Estoque",discontinued:"Descontinuado"};return e.jsx(M,{variant:x[t]||"gray",children:i[t]||t})},ke=({product:t,onEdit:x,onDelete:i,onDuplicate:m,onToggleFeatured:u,onToggleStatus:d})=>{const y=t.main_image_url||t.main_image;return e.jsxs(h,{className:"group overflow-hidden hover:shadow-lg transition-shadow duration-200",children:[e.jsxs("div",{className:"relative aspect-square bg-gray-100 dark:bg-gray-700",children:[y?e.jsx("img",{src:y,alt:t.name,className:"w-full h-full object-cover"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center",children:e.jsx($,{className:"w-16 h-16 text-gray-300"})}),e.jsxs("div",{className:"absolute inset-0 bg-black/50 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center gap-2",children:[e.jsx("button",{onClick:x,className:"p-2 bg-white dark:bg-zinc-900 rounded-full hover:bg-gray-100 dark:hover:bg-zinc-700 dark:hover:bg-zinc-700 transition-colors",title:"Editar",children:e.jsx(te,{className:"w-5 h-5 text-gray-700 dark:text-zinc-300"})}),e.jsx("button",{onClick:m,className:"p-2 bg-white dark:bg-zinc-900 rounded-full hover:bg-gray-100 dark:hover:bg-zinc-700 dark:hover:bg-zinc-700 transition-colors",title:"Duplicar",children:e.jsx(ae,{className:"w-5 h-5 text-gray-700 dark:text-zinc-300"})}),e.jsx("button",{onClick:i,className:"p-2 bg-white dark:bg-zinc-900 rounded-full hover:bg-red-100 dark:bg-red-900/40 transition-colors",title:"Excluir",children:e.jsx(se,{className:"w-5 h-5 text-red-600 dark:text-red-400"})})]}),e.jsx("button",{onClick:u,className:"absolute top-2 right-2 p-1.5 bg-white dark:bg-zinc-900 rounded-full shadow-sm hover:shadow-md transition-shadow",title:t.featured?"Remover destaque":"Destacar",children:t.featured?e.jsx(ie,{className:"w-5 h-5 text-yellow-500"}):e.jsx(le,{className:"w-5 h-5 text-gray-400"})}),t.is_on_sale&&t.discount_percentage&&e.jsxs("div",{className:"absolute top-2 left-2 bg-red-500 text-white text-xs font-bold px-2 py-1 rounded",children:["-",t.discount_percentage,"%"]})]}),e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[t.category_name&&e.jsx("span",{className:"text-xs text-gray-500 dark:text-zinc-400 bg-gray-100 dark:bg-gray-700 px-2 py-0.5 rounded",children:t.category_name}),t.product_type_name&&e.jsx("span",{className:"text-xs text-primary-600 bg-primary-50 px-2 py-0.5 rounded",children:t.product_type_name})]}),e.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white mb-1 line-clamp-2",children:t.name}),e.jsxs("p",{className:"text-xs text-gray-500 dark:text-zinc-400 mb-2",children:["SKU: ",t.sku]}),e.jsxs("div",{className:"flex items-baseline gap-2 mb-3",children:[e.jsx("span",{className:"text-lg font-bold text-primary-600",children:B(t.price)}),t.compare_at_price&&t.compare_at_price>t.price&&e.jsx("span",{className:"text-sm text-gray-400 line-through",children:B(t.compare_at_price)})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(ce,{quantity:t.stock_quantity,threshold:t.low_stock_threshold}),e.jsx("button",{onClick:d,className:"text-xs text-gray-500 dark:text-zinc-400 hover:text-gray-700 dark:hover:text-zinc-300 dark:hover:text-zinc-300",children:e.jsx(ne,{status:t.status})})]})]})]})},Ne=({product:t,onEdit:x,onDelete:i,onDuplicate:m,onToggleFeatured:u,onToggleStatus:d})=>{const y=t.main_image_url||t.main_image;return e.jsxs("tr",{className:"hover:bg-gray-50 dark:hover:bg-zinc-700 dark:bg-black transition-colors",children:[e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-12 h-12 bg-gray-100 dark:bg-gray-700 rounded-lg overflow-hidden flex-shrink-0",children:y?e.jsx("img",{src:y,alt:t.name,className:"w-full h-full object-cover"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center",children:e.jsx($,{className:"w-6 h-6 text-gray-300"})})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900 dark:text-white",children:t.name}),e.jsxs("p",{className:"text-xs text-gray-500 dark:text-zinc-400",children:["SKU: ",t.sku]})]})]})}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex flex-col gap-1",children:[t.category_name&&e.jsx("span",{className:"text-xs text-gray-600 dark:text-zinc-400",children:t.category_name}),t.product_type_name&&e.jsx("span",{className:"text-xs text-primary-600",children:t.product_type_name})]})}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"font-semibold text-gray-900 dark:text-white",children:B(t.price)}),t.compare_at_price&&t.compare_at_price>t.price&&e.jsx("span",{className:"text-xs text-gray-400 line-through",children:B(t.compare_at_price)})]})}),e.jsx("td",{className:"px-4 py-3",children:e.jsx(ce,{quantity:t.stock_quantity,threshold:t.low_stock_threshold})}),e.jsx("td",{className:"px-4 py-3",children:e.jsx(ne,{status:t.status})}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("button",{onClick:u,children:t.featured?e.jsx(ie,{className:"w-5 h-5 text-yellow-500"}):e.jsx(le,{className:"w-5 h-5 text-gray-300 hover:text-yellow-500"})})}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("button",{onClick:x,className:"p-1.5 hover:bg-gray-100 dark:hover:bg-zinc-700 dark:bg-gray-700 rounded-lg transition-colors",title:"Editar",children:e.jsx(te,{className:"w-4 h-4 text-gray-600 dark:text-zinc-400"})}),e.jsx("button",{onClick:m,className:"p-1.5 hover:bg-gray-100 dark:hover:bg-zinc-700 dark:bg-gray-700 rounded-lg transition-colors",title:"Duplicar",children:e.jsx(ae,{className:"w-4 h-4 text-gray-600 dark:text-zinc-400"})}),e.jsx("button",{onClick:i,className:"p-1.5 hover:bg-red-50 rounded-lg transition-colors",title:"Excluir",children:e.jsx(se,{className:"w-4 h-4 text-red-600 dark:text-red-400"})})]})})]})},_e=({isOpen:t,onClose:x,product:i,storeId:m,categories:u,productTypes:d,onSave:y})=>{const z=!!i,[U,R]=o.useState(!1),[k,A]=o.useState("basic"),[j,N]=o.useState(null),[s,c]=o.useState({store:m,name:"",description:"",short_description:"",sku:"",barcode:"",price:0,compare_at_price:void 0,cost_price:void 0,category:null,product_type:null,type_attributes:{},track_stock:!0,stock_quantity:0,low_stock_threshold:5,allow_backorder:!1,status:"active",featured:!1,tags:[],meta_title:"",meta_description:""}),C=o.useMemo(()=>s.product_type&&d.find(r=>r.id===s.product_type)||null,[s.product_type,d]);o.useEffect(()=>{t&&(i?(c({store:m,name:i.name,description:i.description||"",short_description:i.short_description||"",sku:i.sku,barcode:i.barcode||"",price:i.price,compare_at_price:i.compare_at_price,cost_price:i.cost_price,category:i.category,product_type:i.product_type,type_attributes:i.type_attributes||{},track_stock:i.track_stock,stock_quantity:i.stock_quantity,low_stock_threshold:i.low_stock_threshold,allow_backorder:i.allow_backorder,status:i.status,featured:i.featured,tags:i.tags||[],meta_title:i.meta_title||"",meta_description:i.meta_description||""}),N(i.main_image_url||i.main_image||null)):(c({store:m,name:"",description:"",short_description:"",sku:`SKU-${Date.now()}`,barcode:"",price:0,compare_at_price:void 0,cost_price:void 0,category:null,product_type:null,type_attributes:{},track_stock:!0,stock_quantity:0,low_stock_threshold:5,allow_backorder:!1,status:"active",featured:!1,tags:[],meta_title:"",meta_description:""}),N(null)),A("basic"))},[t,i,m]);const S=r=>{const a=r.target.files?.[0];a&&(c(g=>({...g,main_image:a})),j?.startsWith("blob:")&&URL.revokeObjectURL(j),N(URL.createObjectURL(a)))},I=async r=>{if(r.preventDefault(),!s.name.trim()){b.error("Nome é obrigatório");return}if(s.price<=0){b.error("Preço deve ser maior que zero");return}R(!0);try{z&&i?(await v.updateProduct(i.id,s),b.success("Produto atualizado!")):(await v.createProduct(s),b.success("Produto criado!")),y(),x()}catch(a){q.error("Error saving product:",a),b.error("Erro ao salvar produto")}finally{R(!1)}},P=r=>{const a=s.type_attributes?.[r.name]??r.default_value??"",g=E=>{c(n=>({...n,type_attributes:{...n.type_attributes,[r.name]:E}}))};switch(r.type){case"select":return e.jsxs("select",{value:String(a),onChange:n=>g(n.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-zinc-700 rounded-lg focus:ring-2 focus:ring-primary-500",required:r.required,children:[e.jsx("option",{value:"",children:"Selecione..."}),r.options?.map(n=>e.jsx("option",{value:n.value,children:n.label},n.value))]});case"multiselect":const E=Array.isArray(a)?a:[];return e.jsx("div",{className:"space-y-2",children:r.options?.map(n=>e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:E.includes(n.value),onChange:F=>{F.target.checked?g([...E,n.value]):g(E.filter(K=>K!==n.value))},className:"rounded border-gray-300 dark:border-zinc-700 text-primary-600 focus:ring-primary-500"}),e.jsx("span",{className:"text-sm",children:n.label})]},n.value))});case"boolean":return e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:!!a,onChange:n=>g(n.target.checked),className:"rounded border-gray-300 dark:border-zinc-700 text-primary-600 focus:ring-primary-500"}),e.jsx("span",{className:"text-sm",children:r.label})]});case"number":return e.jsx("input",{type:"number",value:Number(a)||"",onChange:n=>g(Number(n.target.value)),min:r.min,max:r.max,step:r.step||1,placeholder:r.placeholder,className:"w-full px-3 py-2 border border-gray-300 dark:border-zinc-700 rounded-lg focus:ring-2 focus:ring-primary-500",required:r.required});case"textarea":return e.jsx("textarea",{value:String(a),onChange:n=>g(n.target.value),rows:r.rows||3,placeholder:r.placeholder,className:"w-full px-3 py-2 border border-gray-300 dark:border-zinc-700 rounded-lg focus:ring-2 focus:ring-primary-500",required:r.required});case"color":return e.jsx("input",{type:"color",value:String(a)||"#000000",onChange:n=>g(n.target.value),className:"w-full h-10 rounded-lg cursor-pointer"});default:return e.jsx("input",{type:"text",value:String(a),onChange:n=>g(n.target.value),placeholder:r.placeholder,className:"w-full px-3 py-2 border border-gray-300 dark:border-zinc-700 rounded-lg focus:ring-2 focus:ring-primary-500",required:r.required})}},O=[{id:"basic",label:"Básico",icon:Q},{id:"pricing",label:"Preços",icon:fe},{id:"inventory",label:"Estoque",icon:Q},{id:"media",label:"Mídia",icon:$},{id:"seo",label:"SEO",icon:ee}];return e.jsx(re,{isOpen:t,onClose:x,title:z?"Editar Produto":"Novo Produto",size:"xl",children:e.jsxs("form",{onSubmit:I,children:[e.jsx("div",{className:"flex border-b border-gray-200 dark:border-zinc-800 mb-6 -mx-6 px-6",children:O.map(r=>{const a=r.icon;return e.jsxs("button",{type:"button",onClick:()=>A(r.id),className:`flex items-center gap-2 px-4 py-3 border-b-2 font-medium text-sm transition-colors ${k===r.id?"border-primary-500 text-primary-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:[e.jsx(a,{className:"w-4 h-4"}),r.label]},r.id)})}),e.jsxs("div",{className:"space-y-6 max-h-[60vh] overflow-y-auto px-1",children:[k==="basic"&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-zinc-300 mb-1",children:"Nome do Produto *"}),e.jsx("input",{type:"text",value:s.name,onChange:r=>c(a=>({...a,name:r.target.value})),className:"w-full px-3 py-2 border border-gray-300 dark:border-zinc-700 rounded-lg focus:ring-2 focus:ring-primary-500",placeholder:"Ex: Rondelli 4 Queijos",required:!0})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-zinc-300 mb-1",children:"Categoria"}),e.jsxs("select",{value:s.category||"",onChange:r=>c(a=>({...a,category:r.target.value||null})),className:"w-full px-3 py-2 border border-gray-300 dark:border-zinc-700 rounded-lg focus:ring-2 focus:ring-primary-500",children:[e.jsx("option",{value:"",children:"Sem categoria"}),u.map(r=>e.jsx("option",{value:r.id,children:r.name},r.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-zinc-300 mb-1",children:"Tipo de Produto"}),e.jsxs("select",{value:s.product_type||"",onChange:r=>c(a=>({...a,product_type:r.target.value||null,type_attributes:{}})),className:"w-full px-3 py-2 border border-gray-300 dark:border-zinc-700 rounded-lg focus:ring-2 focus:ring-primary-500",children:[e.jsx("option",{value:"",children:"Sem tipo"}),d.map(r=>e.jsxs("option",{value:r.id,children:[r.icon," ",r.name]},r.id))]})]})]}),C&&C.custom_fields.length>0&&e.jsxs("div",{className:"border-t pt-4 mt-4",children:[e.jsxs("h4",{className:"text-sm font-medium text-gray-700 dark:text-zinc-300 mb-3",children:["Campos de ",C.name]}),e.jsx("div",{className:"grid grid-cols-2 gap-4",children:C.custom_fields.map(r=>e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-zinc-300 mb-1",children:[r.label," ",r.required&&"*"]}),P(r)]},r.name))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-zinc-300 mb-1",children:"Descrição Curta"}),e.jsx("input",{type:"text",value:s.short_description||"",onChange:r=>c(a=>({...a,short_description:r.target.value})),className:"w-full px-3 py-2 border border-gray-300 dark:border-zinc-700 rounded-lg focus:ring-2 focus:ring-primary-500",placeholder:"Breve descrição para listagens",maxLength:200})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-zinc-300 mb-1",children:"Descrição Completa"}),e.jsx("textarea",{value:s.description||"",onChange:r=>c(a=>({...a,description:r.target.value})),rows:4,className:"w-full px-3 py-2 border border-gray-300 dark:border-zinc-700 rounded-lg focus:ring-2 focus:ring-primary-500",placeholder:"Descrição detalhada do produto..."})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-zinc-300 mb-1",children:"SKU *"}),e.jsx("input",{type:"text",value:s.sku||"",onChange:r=>c(a=>({...a,sku:r.target.value})),className:"w-full px-3 py-2 border border-gray-300 dark:border-zinc-700 rounded-lg focus:ring-2 focus:ring-primary-500",placeholder:"Código único",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-zinc-300 mb-1",children:"Código de Barras"}),e.jsx("input",{type:"text",value:s.barcode||"",onChange:r=>c(a=>({...a,barcode:r.target.value})),className:"w-full px-3 py-2 border border-gray-300 dark:border-zinc-700 rounded-lg focus:ring-2 focus:ring-primary-500",placeholder:"EAN/UPC"})]})]}),e.jsx("div",{className:"flex items-center gap-4",children:e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:s.featured,onChange:r=>c(a=>({...a,featured:r.target.checked})),className:"rounded border-gray-300 dark:border-zinc-700 text-primary-600 focus:ring-primary-500"}),e.jsx("span",{className:"text-sm",children:"Produto em destaque"})]})})]}),k==="pricing"&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-zinc-300 mb-1",children:"Preço de Venda *"}),e.jsxs("div",{className:"relative",children:[e.jsx("span",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-500 dark:text-zinc-400",children:"R$"}),e.jsx("input",{type:"number",value:s.price||"",onChange:r=>c(a=>({...a,price:Number(r.target.value)})),className:"w-full pl-10 pr-3 py-2 border border-gray-300 dark:border-zinc-700 rounded-lg focus:ring-2 focus:ring-primary-500",step:"0.01",min:"0",required:!0})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-zinc-300 mb-1",children:"Preço Comparativo"}),e.jsxs("div",{className:"relative",children:[e.jsx("span",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-500 dark:text-zinc-400",children:"R$"}),e.jsx("input",{type:"number",value:s.compare_at_price??"",onChange:r=>c(a=>({...a,compare_at_price:r.target.value?Number(r.target.value):void 0})),className:"w-full pl-10 pr-3 py-2 border border-gray-300 dark:border-zinc-700 rounded-lg focus:ring-2 focus:ring-primary-500",step:"0.01",min:"0",placeholder:"Preço original"})]}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-zinc-400 mt-1",children:"Para mostrar desconto"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-zinc-300 mb-1",children:"Custo"}),e.jsxs("div",{className:"relative",children:[e.jsx("span",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-500 dark:text-zinc-400",children:"R$"}),e.jsx("input",{type:"number",value:s.cost_price??"",onChange:r=>c(a=>({...a,cost_price:r.target.value?Number(r.target.value):void 0})),className:"w-full pl-10 pr-3 py-2 border border-gray-300 dark:border-zinc-700 rounded-lg focus:ring-2 focus:ring-primary-500",step:"0.01",min:"0",placeholder:"Custo do produto"})]}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-zinc-400 mt-1",children:"Para cálculo de margem"})]})]}),s.price>0&&s.cost_price&&s.cost_price>0&&e.jsxs(h,{className:"p-4 bg-gray-50 dark:bg-black",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-700 dark:text-zinc-300 mb-2",children:"Análise de Margem"}),e.jsxs("div",{className:"grid grid-cols-3 gap-4 text-center",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold text-green-600 dark:text-green-400",children:B(s.price-s.cost_price)}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-zinc-400",children:"Lucro Bruto"})]}),e.jsxs("div",{children:[e.jsxs("p",{className:"text-2xl font-bold text-blue-600 dark:text-blue-400",children:[((s.price-s.cost_price)/s.price*100).toFixed(1),"%"]}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-zinc-400",children:"Margem"})]}),e.jsxs("div",{children:[e.jsxs("p",{className:"text-2xl font-bold text-purple-600 dark:text-purple-400",children:[((s.price-s.cost_price)/s.cost_price*100).toFixed(1),"%"]}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-zinc-400",children:"Markup"})]})]})]})]}),k==="inventory"&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:s.track_stock,onChange:r=>c(a=>({...a,track_stock:r.target.checked})),className:"rounded border-gray-300 dark:border-zinc-700 text-primary-600 focus:ring-primary-500"}),e.jsx("span",{className:"text-sm font-medium",children:"Controlar estoque"})]}),s.track_stock&&e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-zinc-300 mb-1",children:"Quantidade em Estoque"}),e.jsx("input",{type:"number",value:s.stock_quantity||0,onChange:r=>c(a=>({...a,stock_quantity:Number(r.target.value)})),className:"w-full px-3 py-2 border border-gray-300 dark:border-zinc-700 rounded-lg focus:ring-2 focus:ring-primary-500",min:"0"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-zinc-300 mb-1",children:"Alerta de Estoque Baixo"}),e.jsx("input",{type:"number",value:s.low_stock_threshold||5,onChange:r=>c(a=>({...a,low_stock_threshold:Number(r.target.value)})),className:"w-full px-3 py-2 border border-gray-300 dark:border-zinc-700 rounded-lg focus:ring-2 focus:ring-primary-500",min:"0"})]}),e.jsx("div",{className:"flex items-end",children:e.jsxs("label",{className:"flex items-center gap-2 pb-2",children:[e.jsx("input",{type:"checkbox",checked:s.allow_backorder,onChange:r=>c(a=>({...a,allow_backorder:r.target.checked})),className:"rounded border-gray-300 dark:border-zinc-700 text-primary-600 focus:ring-primary-500"}),e.jsx("span",{className:"text-sm",children:"Permitir venda sem estoque"})]})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-zinc-300 mb-1",children:"Status do Produto"}),e.jsxs("select",{value:s.status,onChange:r=>c(a=>({...a,status:r.target.value})),className:"w-full px-3 py-2 border border-gray-300 dark:border-zinc-700 rounded-lg focus:ring-2 focus:ring-primary-500",children:[e.jsx("option",{value:"active",children:"Ativo"}),e.jsx("option",{value:"inactive",children:"Inativo"}),e.jsx("option",{value:"out_of_stock",children:"Sem Estoque"}),e.jsx("option",{value:"discontinued",children:"Descontinuado"})]})]})]}),k==="media"&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-zinc-300 mb-2",children:"Imagem Principal"}),e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"w-40 h-40 bg-gray-100 dark:bg-gray-700 rounded-lg overflow-hidden flex items-center justify-center border-2 border-dashed border-gray-300 dark:border-zinc-700",children:j?e.jsx("img",{src:j,alt:"Preview",className:"w-full h-full object-cover"}):e.jsx($,{className:"w-12 h-12 text-gray-400"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("input",{type:"file",accept:"image/*",onChange:S,className:"hidden",id:"product-image"}),e.jsxs("label",{htmlFor:"product-image",className:"inline-flex items-center gap-2 px-4 py-2 bg-white dark:bg-zinc-900 border border-gray-300 dark:border-zinc-700 rounded-lg cursor-pointer hover:bg-gray-50 dark:hover:bg-zinc-700 dark:bg-black transition-colors",children:[e.jsx($,{className:"w-5 h-5"}),"Escolher Imagem"]}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-zinc-400 mt-2",children:"Recomendado: 800x800px, JPG ou PNG, máx 2MB"}),j&&e.jsx("button",{type:"button",onClick:()=>{N(null),c(r=>({...r,main_image:null}))},className:"text-sm text-red-600 dark:text-red-400 hover:text-red-700 dark:text-red-300 mt-2",children:"Remover imagem"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-zinc-300 mb-1",children:"URL da Imagem (alternativo)"}),e.jsx("input",{type:"url",value:s.main_image_url||"",onChange:r=>c(a=>({...a,main_image_url:r.target.value})),className:"w-full px-3 py-2 border border-gray-300 dark:border-zinc-700 rounded-lg focus:ring-2 focus:ring-primary-500",placeholder:"https://exemplo.com/imagem.jpg"})]})]}),k==="seo"&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-zinc-300 mb-1",children:"Título SEO"}),e.jsx("input",{type:"text",value:s.meta_title||"",onChange:r=>c(a=>({...a,meta_title:r.target.value})),className:"w-full px-3 py-2 border border-gray-300 dark:border-zinc-700 rounded-lg focus:ring-2 focus:ring-primary-500",placeholder:s.name||"Título para mecanismos de busca",maxLength:60}),e.jsxs("p",{className:"text-xs text-gray-500 dark:text-zinc-400 mt-1",children:[(s.meta_title||s.name||"").length,"/60 caracteres"]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-zinc-300 mb-1",children:"Descrição SEO"}),e.jsx("textarea",{value:s.meta_description||"",onChange:r=>c(a=>({...a,meta_description:r.target.value})),rows:3,className:"w-full px-3 py-2 border border-gray-300 dark:border-zinc-700 rounded-lg focus:ring-2 focus:ring-primary-500",placeholder:s.short_description||"Descrição para mecanismos de busca",maxLength:160}),e.jsxs("p",{className:"text-xs text-gray-500 dark:text-zinc-400 mt-1",children:[(s.meta_description||s.short_description||"").length,"/160 caracteres"]})]}),e.jsxs(h,{className:"p-4 bg-gray-50 dark:bg-black",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-700 dark:text-zinc-300 mb-2",children:"Prévia no Google"}),e.jsxs("div",{className:"bg-white dark:bg-zinc-900 p-3 rounded border",children:[e.jsx("p",{className:"text-blue-600 dark:text-blue-400 text-lg hover:underline cursor-pointer",children:s.meta_title||s.name||"Título do Produto"}),e.jsxs("p",{className:"text-green-700 dark:text-green-300 text-sm",children:["sualoja.com.br › produtos › ",s.sku||"sku"]}),e.jsx("p",{className:"text-gray-600 dark:text-zinc-400 text-sm line-clamp-2",children:s.meta_description||s.short_description||s.description||"Descrição do produto aparecerá aqui..."})]})]})]})]}),e.jsxs("div",{className:"flex justify-end gap-3 mt-6 pt-4 border-t",children:[e.jsx(w,{type:"button",variant:"secondary",onClick:x,children:"Cancelar"}),e.jsx(w,{type:"submit",isLoading:U,children:z?"Salvar Alterações":"Criar Produto"})]})]})})},Re=()=>{const t=me(),{storeId:x}=ue(),{storeId:i,storeName:m}=ge(),u=x||i,[d,y]=o.useState([]),[z,U]=o.useState([]),[R,k]=o.useState([]),[A,j]=o.useState(!0),[N,s]=o.useState("grid"),[c,C]=o.useState(""),[S,I]=o.useState(""),[P,O]=o.useState(""),[r,a]=o.useState(""),[g,E]=o.useState(!1),[n,F]=o.useState(!1),[K,G]=o.useState(null),[L,D]=o.useState(null),_=o.useCallback(async()=>{if(!u){j(!1);return}try{j(!0);const[l,p,V]=await Promise.all([v.getProducts({store:u,search:c||void 0,category:S||void 0,product_type:P||void 0,status:r||void 0,page_size:100}),v.getCategories(u),v.getProductTypes(u)]);y(l.results),U(p.results||[]),k(V.results||[])}catch(l){q.error("Error loading products:",l),b.error("Erro ao carregar produtos")}finally{j(!1)}},[u,c,S,P,r]);o.useEffect(()=>{_()},[_]);const X=l=>{G(l),F(!0)},J=()=>{G(null),F(!0)},oe=async()=>{if(L)try{await v.deleteProduct(L.id),b.success("Produto excluído!"),D(null),_()}catch(l){q.error("Error deleting product:",l),b.error("Erro ao excluir produto")}},W=async l=>{try{await v.duplicateProduct(l.id),b.success("Produto duplicado!"),_()}catch(p){q.error("Error duplicating product:",p),b.error("Erro ao duplicar produto")}},Z=async l=>{try{await v.updateProduct(l.id,{featured:!l.featured}),_()}catch(p){q.error("Error toggling featured:",p)}},H=async l=>{try{const p=l.status==="active"?"inactive":"active";await v.updateProduct(l.id,{status:p}),_()}catch(p){q.error("Error toggling status:",p)}},T=o.useMemo(()=>{const l=d.length,p=d.filter(f=>f.status==="active").length,V=d.filter(f=>f.stock_quantity<=(f.low_stock_threshold||5)&&f.stock_quantity>0).length,de=d.filter(f=>f.stock_quantity<=0).length,xe=d.filter(f=>f.featured).length;return{total:l,active:p,lowStock:V,outOfStock:de,featured:xe}},[d]);return u?A&&d.length===0?e.jsx(he,{}):e.jsxs("div",{className:"p-4 md:p-6 space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Produtos"}),e.jsx("p",{className:"text-gray-500 dark:text-zinc-400",children:m?`Catálogo de ${m}`:"Gerencie seu catálogo de produtos"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(w,{variant:"secondary",onClick:_,title:"Atualizar",children:e.jsx(be,{className:"w-5 h-5"})}),e.jsxs(w,{onClick:J,children:[e.jsx(Y,{className:"w-5 h-5 mr-2"}),"Novo Produto"]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-4",children:[e.jsxs(h,{className:"p-4 text-center",children:[e.jsx("p",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:T.total}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-zinc-400",children:"Total"})]}),e.jsxs(h,{className:"p-4 text-center",children:[e.jsx("p",{className:"text-3xl font-bold text-green-600 dark:text-green-400",children:T.active}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-zinc-400",children:"Ativos"})]}),e.jsxs(h,{className:"p-4 text-center",children:[e.jsx("p",{className:"text-3xl font-bold text-yellow-600 dark:text-yellow-400",children:T.lowStock}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-zinc-400",children:"Estoque Baixo"})]}),e.jsxs(h,{className:"p-4 text-center",children:[e.jsx("p",{className:"text-3xl font-bold text-red-600 dark:text-red-400",children:T.outOfStock}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-zinc-400",children:"Sem Estoque"})]}),e.jsxs(h,{className:"p-4 text-center",children:[e.jsx("p",{className:"text-3xl font-bold text-purple-600 dark:text-purple-400",children:T.featured}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-zinc-400",children:"Destaques"})]})]}),e.jsx(h,{className:"p-4",children:e.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(ee,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"}),e.jsx("input",{type:"text",value:c,onChange:l=>C(l.target.value),placeholder:"Buscar por nome, SKU...",className:"w-full pl-10 pr-4 py-2 border border-gray-300 dark:border-zinc-700 rounded-lg focus:ring-2 focus:ring-primary-500"})]}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsxs("select",{value:S,onChange:l=>I(l.target.value),className:"px-3 py-2 border border-gray-300 dark:border-zinc-700 rounded-lg focus:ring-2 focus:ring-primary-500 text-sm",children:[e.jsx("option",{value:"",children:"Todas Categorias"}),z.map(l=>e.jsx("option",{value:l.id,children:l.name},l.id))]}),e.jsxs("select",{value:P,onChange:l=>O(l.target.value),className:"px-3 py-2 border border-gray-300 dark:border-zinc-700 rounded-lg focus:ring-2 focus:ring-primary-500 text-sm",children:[e.jsx("option",{value:"",children:"Todos Tipos"}),R.map(l=>e.jsxs("option",{value:l.id,children:[l.icon," ",l.name]},l.id))]}),e.jsxs("select",{value:r,onChange:l=>a(l.target.value),className:"px-3 py-2 border border-gray-300 dark:border-zinc-700 rounded-lg focus:ring-2 focus:ring-primary-500 text-sm",children:[e.jsx("option",{value:"",children:"Todos Status"}),e.jsx("option",{value:"active",children:"Ativos"}),e.jsx("option",{value:"inactive",children:"Inativos"}),e.jsx("option",{value:"out_of_stock",children:"Sem Estoque"}),e.jsx("option",{value:"discontinued",children:"Descontinuados"})]}),e.jsxs("div",{className:"flex items-center bg-gray-100 dark:bg-gray-700 rounded-lg p-1",children:[e.jsx("button",{onClick:()=>s("grid"),className:`p-1.5 rounded ${N==="grid"?"bg-white dark:bg-gray-700 shadow-sm":"text-gray-500 dark:text-zinc-400"}`,children:e.jsx(ye,{className:"w-5 h-5"})}),e.jsx("button",{onClick:()=>s("list"),className:`p-1.5 rounded ${N==="list"?"bg-white dark:bg-gray-700 shadow-sm":"text-gray-500 dark:text-zinc-400"}`,children:e.jsx(je,{className:"w-5 h-5"})})]})]})]})}),d.length===0?e.jsxs(h,{className:"p-12 text-center",children:[e.jsx(Q,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-2",children:"Nenhum produto encontrado"}),e.jsx("p",{className:"text-gray-500 dark:text-zinc-400 mb-4",children:c||S||P||r?"Tente ajustar os filtros":"Comece adicionando seu primeiro produto"}),e.jsxs(w,{onClick:J,children:[e.jsx(Y,{className:"w-5 h-5 mr-2"}),"Adicionar Produto"]})]}):N==="grid"?e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4",children:d.map(l=>e.jsx(ke,{product:l,onEdit:()=>X(l),onDelete:()=>D(l),onDuplicate:()=>W(l),onToggleFeatured:()=>Z(l),onToggleStatus:()=>H(l)},l.id))}):e.jsx(h,{className:"overflow-hidden",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50 dark:bg-black border-b",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-zinc-400 uppercase",children:"Produto"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-zinc-400 uppercase",children:"Categoria/Tipo"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-zinc-400 uppercase",children:"Preço"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-zinc-400 uppercase",children:"Estoque"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-zinc-400 uppercase",children:"Status"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-zinc-400 uppercase",children:"Destaque"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-zinc-400 uppercase",children:"Ações"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200",children:d.map(l=>e.jsx(Ne,{product:l,onEdit:()=>X(l),onDelete:()=>D(l),onDuplicate:()=>W(l),onToggleFeatured:()=>Z(l),onToggleStatus:()=>H(l)},l.id))})]})}),e.jsx(_e,{isOpen:n,onClose:()=>{F(!1),G(null)},product:K,storeId:u,categories:z,productTypes:R,onSave:_}),e.jsx(re,{isOpen:!!L,onClose:()=>D(null),title:"Excluir Produto",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("p",{className:"text-gray-600 dark:text-zinc-400",children:["Tem certeza que deseja excluir o produto ",e.jsx("strong",{children:L?.name}),"?"]}),e.jsx("p",{className:"text-sm text-red-600 dark:text-red-400",children:"Esta ação não pode ser desfeita."}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx(w,{variant:"secondary",onClick:()=>D(null),children:"Cancelar"}),e.jsx(w,{variant:"danger",onClick:oe,children:"Excluir"})]})]})})]}):e.jsxs("div",{className:"p-6 text-center",children:[e.jsx(pe,{className:"w-16 h-16 text-yellow-500 mx-auto mb-4"}),e.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white mb-2",children:"Nenhuma loja selecionada"}),e.jsx("p",{className:"text-gray-500 dark:text-zinc-400 mb-4",children:"Selecione uma loja no menu superior para gerenciar produtos."}),e.jsx(w,{onClick:()=>t("/stores"),children:"Ver Lojas"})]})};export{Re as ProductsPageNew,Re as default};
