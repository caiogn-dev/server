import{j as e}from"./vendor-charts-o9Lo7m6Z.js";import{e as O,r as o,u as G,L as $}from"./vendor-react-C2HNIXra.js";import{b2 as C,l as w,a5 as V,X as j,a4 as f,b1 as W,ah as q,W as k,N as Q,R as E,ac as Y,B as R,aN as ee,ag as ae,af as H,ae as se,b3 as K,e as Z,h as J,aw as A,n as U,d as te,b6 as re,b7 as _,aa as le,ay as ie,a2 as de,z as ne,b8 as D}from"./feature-automation-CLWK1V5x.js";import{P as I,S as T,b as M,c as B,Z as ce,d as oe,e as xe,R as me}from"./vendor-ui-B9rDAafI.js";import"./index-DQDVHdIA.js";import"./vendor-utils-DaXQUBrP.js";import"./vendor-mui-DKuE-Kg_.js";const Ne=()=>{const x=O(),[m,N]=o.useState([]),[t,d]=o.useState(!0),[u,p]=o.useState(!1),[b,y]=o.useState(null),[r,i]=o.useState({});o.useEffect(()=>{c()},[]);const c=async()=>{try{d(!0);const s=await C.getStores();N(s.results);for(const n of s.results)try{const S=await C.getStoreStats(n.id);i(P=>({...P,[n.id]:S}))}catch(S){w.error(`Failed to load stats for store ${n.id}`,S)}}catch(s){w.error("Failed to load stores",s)}finally{d(!1)}},v=async s=>{try{const n=await C.createStore(s);N(S=>[n,...S]),p(!1)}catch(n){w.error("Failed to create store",n)}},l=async s=>{try{const n=await C.syncPastitaToStore(s);alert(`Sincroniza√ß√£o conclu√≠da!
${JSON.stringify(n.synced,null,2)}`),c()}catch(n){w.error("Failed to sync Pastita",n)}},h=s=>{const n={active:"success",inactive:"gray",suspended:"danger",pending:"warning"};return e.jsx(W,{variant:n[s]||"gray",children:s})},z=s=>({food:"üçï Alimenta√ß√£o",retail:"üõçÔ∏è Varejo",services:"üîß Servi√ßos",digital:"üíª Digital",other:"üì¶ Outro"})[s]||s;return t?e.jsx(V,{}):e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Lojas"}),e.jsx("p",{className:"text-gray-600 dark:text-zinc-400",children:"Gerencie todas as suas lojas e integra√ß√µes"})]}),e.jsxs(j,{onClick:()=>p(!0),children:[e.jsx(I,{className:"w-4 h-4 mr-2"}),"Nova Loja"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[e.jsx(f,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-blue-100 dark:bg-blue-900/40 rounded-lg",children:e.jsx(T,{className:"w-6 h-6 text-blue-600 dark:text-blue-400"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600 dark:text-zinc-400",children:"Total de Lojas"}),e.jsx("p",{className:"text-2xl font-bold",children:m.length})]})]})}),e.jsx(f,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-green-100 dark:bg-green-900/40 rounded-lg",children:e.jsx(M,{className:"w-6 h-6 text-green-600 dark:text-green-400"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600 dark:text-zinc-400",children:"Total de Produtos"}),e.jsx("p",{className:"text-2xl font-bold",children:m.reduce((s,n)=>s+n.products_count,0)})]})]})}),e.jsx(f,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-purple-100 dark:bg-purple-900/40 rounded-lg",children:e.jsx(B,{className:"w-6 h-6 text-purple-600 dark:text-purple-400"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600 dark:text-zinc-400",children:"Total de Pedidos"}),e.jsx("p",{className:"text-2xl font-bold",children:m.reduce((s,n)=>s+n.orders_count,0)})]})]})}),e.jsx(f,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-orange-100 rounded-lg",children:e.jsx(ce,{className:"w-6 h-6 text-orange-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600 dark:text-zinc-400",children:"Integra√ß√µes Ativas"}),e.jsx("p",{className:"text-2xl font-bold",children:m.reduce((s,n)=>s+n.integrations_count,0)})]})]})})]}),m.length===0?e.jsxs(f,{className:"p-12 text-center",children:[e.jsx(T,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-2",children:"Nenhuma loja cadastrada"}),e.jsx("p",{className:"text-gray-600 dark:text-zinc-400 mb-4",children:"Crie sua primeira loja para come√ßar a vender"}),e.jsxs(j,{onClick:()=>p(!0),children:[e.jsx(I,{className:"w-4 h-4 mr-2"}),"Criar Loja"]})]}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:m.map(s=>{const n=r[s.id];return e.jsxs(f,{className:"overflow-hidden",children:[e.jsx("div",{className:"p-4 border-b",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[s.logo_url?e.jsx("img",{src:s.logo_url,alt:s.name,className:"w-12 h-12 rounded-lg object-cover"}):e.jsx("div",{className:"w-12 h-12 rounded-lg bg-gray-100 dark:bg-gray-700 flex items-center justify-center",children:e.jsx(T,{className:"w-6 h-6 text-gray-400"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white",children:s.name}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-zinc-400",children:z(s.store_type)})]})]}),h(s.status)]})}),e.jsxs("div",{className:"p-4 grid grid-cols-3 gap-4 text-center border-b",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:s.products_count}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-zinc-400",children:"Produtos"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:s.orders_count}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-zinc-400",children:"Pedidos"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:s.integrations_count}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-zinc-400",children:"Integra√ß√µes"})]})]}),n&&e.jsxs("div",{className:"p-4 bg-gray-50 dark:bg-black border-b",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-gray-600 dark:text-zinc-400",children:"Receita Total"}),e.jsxs("span",{className:"font-semibold text-green-600 dark:text-green-400",children:["R$ ",n.revenue.total.toLocaleString("pt-BR",{minimumFractionDigits:2})]})]}),e.jsxs("div",{className:"flex justify-between items-center mt-1",children:[e.jsx("span",{className:"text-sm text-gray-600 dark:text-zinc-400",children:"Hoje"}),e.jsxs("span",{className:"font-medium text-gray-900 dark:text-white",children:["R$ ",n.revenue.today.toLocaleString("pt-BR",{minimumFractionDigits:2})]})]})]}),e.jsxs("div",{className:"p-4 flex flex-wrap gap-2",children:[e.jsxs(j,{variant:"secondary",size:"sm",onClick:()=>x(`/stores/${s.id}`),children:[e.jsx(oe,{className:"w-4 h-4 mr-1"}),"Gerenciar"]}),e.jsxs(j,{variant:"secondary",size:"sm",onClick:()=>x(`/stores/${s.id}/products`),children:[e.jsx(M,{className:"w-4 h-4 mr-1"}),"Produtos"]}),e.jsxs(j,{variant:"secondary",size:"sm",onClick:()=>x(`/stores/${s.id}/orders`),children:[e.jsx(B,{className:"w-4 h-4 mr-1"}),"Pedidos"]}),e.jsxs(j,{variant:"secondary",size:"sm",onClick:()=>x(`/stores/${s.id}/analytics`),children:[e.jsx(xe,{className:"w-4 h-4 mr-1"}),"Analytics"]}),s.slug==="pastita"&&e.jsxs(j,{variant:"secondary",size:"sm",onClick:()=>l(s.id),children:[e.jsx(me,{className:"w-4 h-4 mr-1"}),"Sync Pastita"]})]})]},s.id)})}),e.jsx(ge,{isOpen:u,onClose:()=>p(!1),onSubmit:v})]})},ge=({isOpen:x,onClose:m,onSubmit:N})=>{const[t,d]=o.useState({name:"",slug:"",description:"",store_type:"food",email:"",phone:"",whatsapp_number:"",address:"",city:"",state:"",zip_code:"",delivery_enabled:!0,pickup_enabled:!0,min_order_value:0,default_delivery_fee:10}),[u,p]=o.useState(!1),b=async r=>{r.preventDefault(),p(!0);try{await N(t),d({name:"",slug:"",description:"",store_type:"food",email:"",phone:"",whatsapp_number:"",address:"",city:"",state:"",zip_code:"",delivery_enabled:!0,pickup_enabled:!0,min_order_value:0,default_delivery_fee:10})}finally{p(!1)}},y=r=>r.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/[^a-z0-9]+/g,"-").replace(/(^-|-$)/g,"");return e.jsx(q,{isOpen:x,onClose:m,title:"Nova Loja",size:"lg",children:e.jsxs("form",{onSubmit:b,className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(k,{label:"Nome da Loja",value:t.name,onChange:r=>{d(i=>({...i,name:r.target.value,slug:y(r.target.value)}))},required:!0}),e.jsx(k,{label:"Slug (URL)",value:t.slug,onChange:r=>d(i=>({...i,slug:r.target.value})),required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-zinc-300 mb-1",children:"Tipo de Loja"}),e.jsxs("select",{value:t.store_type,onChange:r=>d(i=>({...i,store_type:r.target.value})),className:"w-full px-3 py-2 border border-gray-300 dark:border-zinc-700 rounded-lg focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"food",children:"üçï Alimenta√ß√£o"}),e.jsx("option",{value:"retail",children:"üõçÔ∏è Varejo"}),e.jsx("option",{value:"services",children:"üîß Servi√ßos"}),e.jsx("option",{value:"digital",children:"üíª Digital"}),e.jsx("option",{value:"other",children:"üì¶ Outro"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-zinc-300 mb-1",children:"Descri√ß√£o"}),e.jsx("textarea",{value:t.description,onChange:r=>d(i=>({...i,description:r.target.value})),rows:3,className:"w-full px-3 py-2 border border-gray-300 dark:border-zinc-700 rounded-lg focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(k,{label:"Email",type:"email",value:t.email,onChange:r=>d(i=>({...i,email:r.target.value}))}),e.jsx(k,{label:"Telefone",value:t.phone,onChange:r=>d(i=>({...i,phone:r.target.value}))})]}),e.jsx(k,{label:"WhatsApp",value:t.whatsapp_number,onChange:r=>d(i=>({...i,whatsapp_number:r.target.value})),placeholder:"5511999999999"}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsx(k,{label:"Cidade",value:t.city,onChange:r=>d(i=>({...i,city:r.target.value}))}),e.jsx(k,{label:"Estado",value:t.state,onChange:r=>d(i=>({...i,state:r.target.value}))}),e.jsx(k,{label:"CEP",value:t.zip_code,onChange:r=>d(i=>({...i,zip_code:r.target.value}))})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(k,{label:"Pedido M√≠nimo (R$)",type:"number",value:t.min_order_value,onChange:r=>d(i=>({...i,min_order_value:parseFloat(r.target.value)||0}))}),e.jsx(k,{label:"Taxa de Entrega Padr√£o (R$)",type:"number",value:t.default_delivery_fee,onChange:r=>d(i=>({...i,default_delivery_fee:parseFloat(r.target.value)||0}))})]}),e.jsxs("div",{className:"flex gap-4",children:[e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:t.delivery_enabled,onChange:r=>d(i=>({...i,delivery_enabled:r.target.checked})),className:"rounded"}),e.jsx("span",{className:"text-sm",children:"Entrega habilitada"})]}),e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:t.pickup_enabled,onChange:r=>d(i=>({...i,pickup_enabled:r.target.checked})),className:"rounded"}),e.jsx("span",{className:"text-sm",children:"Retirada habilitada"})]})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t",children:[e.jsx(j,{variant:"secondary",onClick:m,type:"button",children:"Cancelar"}),e.jsx(j,{type:"submit",disabled:u,children:u?"Criando...":"Criar Loja"})]})]})})},ue=[{id:"overview",label:"Vis√£o Geral",icon:se},{id:"products",label:"Produtos",icon:K,path:"products"},{id:"orders",label:"Pedidos",icon:Z,path:"orders"},{id:"coupons",label:"Cupons",icon:J,path:"coupons"},{id:"delivery",label:"Entrega",icon:A,path:"delivery"},{id:"settings",label:"Configura√ß√µes",icon:U,path:"settings"}],ke=()=>{const{storeId:x}=G(),m=O(),{setSelectedStore:N}=Q(),[t,d]=o.useState(null),[u,p]=o.useState(null),[b,y]=o.useState(!0),[r,i]=o.useState("overview"),[c,v]=o.useState(!1),l=o.useCallback(async()=>{if(x)try{y(!0);const[s,n]=await Promise.all([C.getStore(x),C.getStoreStats(x)]);d(s),p(n),N(s)}catch(s){w.error("Failed to load store:",s),E.error("Erro ao carregar loja"),m("/stores")}finally{y(!1)}},[x,m,N]);o.useEffect(()=>{l()},[l]);const h=async()=>{if(t)try{t.status==="active"?(await C.deactivateStore(t.id),E.success("Loja desativada")):(await C.activateStore(t.id),E.success("Loja ativada")),l()}catch(s){w.error("Failed to toggle store status:",s),E.error("Erro ao alterar status")}},z=s=>{s.path?m(`/stores/${x}/${s.path}`):i(s.id)};return b?e.jsx(V,{}):t?e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"mb-6",children:[e.jsxs("button",{onClick:()=>m("/stores"),className:"flex items-center text-gray-600 dark:text-zinc-400 hover:text-gray-900 dark:text-white mb-4",children:[e.jsx(Y,{className:"w-4 h-4 mr-2"}),"Voltar para Lojas"]}),e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[t.logo_url?e.jsx("img",{src:t.logo_url,alt:t.name,className:"w-16 h-16 rounded-xl object-cover"}):e.jsx("div",{className:"w-16 h-16 rounded-xl bg-primary-100 flex items-center justify-center",children:e.jsx(R,{className:"w-8 h-8 text-primary-600"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:t.name}),e.jsx("p",{className:"text-gray-500 dark:text-zinc-400",children:t.slug}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsx(W,{variant:t.status==="active"?"success":"gray",children:t.status==="active"?"Ativa":"Inativa"}),e.jsx("span",{className:"text-sm text-gray-500 dark:text-zinc-400",children:t.store_type==="food"?"üçï Alimenta√ß√£o":t.store_type})]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(j,{variant:"secondary",onClick:()=>v(!0),children:[e.jsx(ee,{className:"w-4 h-4 mr-2"}),"Editar"]}),e.jsx(j,{variant:t.status==="active"?"danger":"primary",onClick:h,children:t.status==="active"?e.jsxs(e.Fragment,{children:[e.jsx(ae,{className:"w-4 h-4 mr-2"}),"Desativar"]}):e.jsxs(e.Fragment,{children:[e.jsx(H,{className:"w-4 h-4 mr-2"}),"Ativar"]})})]})]})]}),u&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[e.jsxs(f,{className:"p-4",children:[e.jsx("p",{className:"text-sm text-gray-600 dark:text-zinc-400",children:"Receita Total"}),e.jsxs("p",{className:"text-2xl font-bold text-green-600 dark:text-green-400",children:["R$ ",u.revenue.total.toLocaleString("pt-BR",{minimumFractionDigits:2})]}),e.jsxs("p",{className:"text-xs text-gray-500 dark:text-zinc-400",children:["Hoje: R$ ",u.revenue.today.toLocaleString("pt-BR",{minimumFractionDigits:2})]})]}),e.jsxs(f,{className:"p-4",children:[e.jsx("p",{className:"text-sm text-gray-600 dark:text-zinc-400",children:"Pedidos"}),e.jsx("p",{className:"text-2xl font-bold text-blue-600 dark:text-blue-400",children:u.orders.total}),e.jsxs("p",{className:"text-xs text-gray-500 dark:text-zinc-400",children:["Hoje: ",u.orders.today]})]}),e.jsxs(f,{className:"p-4",children:[e.jsx("p",{className:"text-sm text-gray-600 dark:text-zinc-400",children:"Produtos"}),e.jsx("p",{className:"text-2xl font-bold text-purple-600 dark:text-purple-400",children:u.products.total}),e.jsxs("p",{className:"text-xs text-gray-500 dark:text-zinc-400",children:["Ativos: ",u.products.active]})]}),e.jsxs(f,{className:"p-4",children:[e.jsx("p",{className:"text-sm text-gray-600 dark:text-zinc-400",children:"Clientes"}),e.jsx("p",{className:"text-2xl font-bold text-orange-600",children:u.customers.total}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-zinc-400",children:"Total cadastrados"})]})]}),e.jsx("div",{className:"border-b border-gray-200 dark:border-zinc-800 mb-6",children:e.jsx("nav",{className:"flex gap-4 overflow-x-auto",children:ue.map(s=>{const n=s.icon,S=r===s.id;return e.jsxs("button",{onClick:()=>z(s),className:`
                  flex items-center gap-2 px-4 py-3 border-b-2 font-medium text-sm whitespace-nowrap
                  transition-colors duration-200
                  ${S?"border-primary-500 text-primary-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}
                `,children:[e.jsx(n,{className:"w-5 h-5"}),s.label]},s.id)})})}),r==="overview"&&e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(f,{className:"p-6",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"A√ß√µes R√°pidas"}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs($,{to:`/stores/${x}/products`,className:"flex items-center gap-3 p-4 bg-gray-50 dark:bg-black rounded-lg hover:bg-gray-100 dark:hover:bg-zinc-700 dark:hover:bg-zinc-800 transition-colors",children:[e.jsx(K,{className:"w-8 h-8 text-purple-600 dark:text-purple-400"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"Produtos"}),e.jsxs("p",{className:"text-sm text-gray-500 dark:text-zinc-400",children:[t.products_count," itens"]})]})]}),e.jsxs($,{to:`/stores/${x}/orders`,className:"flex items-center gap-3 p-4 bg-gray-50 dark:bg-black rounded-lg hover:bg-gray-100 dark:hover:bg-zinc-700 dark:hover:bg-zinc-800 transition-colors",children:[e.jsx(Z,{className:"w-8 h-8 text-blue-600 dark:text-blue-400"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"Pedidos"}),e.jsxs("p",{className:"text-sm text-gray-500 dark:text-zinc-400",children:[t.orders_count," pedidos"]})]})]}),e.jsxs($,{to:`/stores/${x}/coupons`,className:"flex items-center gap-3 p-4 bg-gray-50 dark:bg-black rounded-lg hover:bg-gray-100 dark:hover:bg-zinc-700 dark:hover:bg-zinc-800 transition-colors",children:[e.jsx(J,{className:"w-8 h-8 text-green-600 dark:text-green-400"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"Cupons"}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-zinc-400",children:"Gerenciar descontos"})]})]}),e.jsxs($,{to:`/stores/${x}/delivery`,className:"flex items-center gap-3 p-4 bg-gray-50 dark:bg-black rounded-lg hover:bg-gray-100 dark:hover:bg-zinc-700 dark:hover:bg-zinc-800 transition-colors",children:[e.jsx(A,{className:"w-8 h-8 text-orange-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"Entrega"}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-zinc-400",children:"Zonas e taxas"})]})]})]})]}),e.jsxs(f,{className:"p-6",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Informa√ß√µes da Loja"}),e.jsxs("div",{className:"space-y-3",children:[t.email&&e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500 dark:text-zinc-400",children:"Email"}),e.jsx("p",{className:"font-medium",children:t.email})]}),t.phone&&e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500 dark:text-zinc-400",children:"Telefone"}),e.jsx("p",{className:"font-medium",children:t.phone})]}),t.whatsapp_number&&e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500 dark:text-zinc-400",children:"WhatsApp"}),e.jsx("p",{className:"font-medium",children:t.whatsapp_number})]}),t.address&&e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500 dark:text-zinc-400",children:"Endere√ßo"}),e.jsxs("p",{className:"font-medium",children:[t.address,t.city&&`, ${t.city}`,t.state&&` - ${t.state}`]})]}),e.jsxs("div",{className:"pt-3 border-t",children:[e.jsx("p",{className:"text-sm text-gray-500 dark:text-zinc-400",children:"Configura√ß√µes de Entrega"}),e.jsxs("div",{className:"flex gap-4 mt-1",children:[e.jsx("span",{className:`text-sm ${t.delivery_enabled?"text-green-600":"text-gray-400"}`,children:t.delivery_enabled?"‚úì Delivery":"‚úó Delivery"}),e.jsx("span",{className:`text-sm ${t.pickup_enabled?"text-green-600":"text-gray-400"}`,children:t.pickup_enabled?"‚úì Retirada":"‚úó Retirada"})]})]})]})]})]}),e.jsxs(q,{isOpen:c,onClose:()=>v(!1),title:"Editar Loja",size:"lg",children:[e.jsx("p",{className:"text-gray-500 dark:text-zinc-400",children:"Funcionalidade de edi√ß√£o em desenvolvimento. Por enquanto, use o Django Admin para editar os dados da loja."}),e.jsx("div",{className:"flex justify-end mt-4",children:e.jsx(j,{onClick:()=>v(!1),children:"Fechar"})})]})]}):e.jsxs("div",{className:"p-6 text-center",children:[e.jsx("p",{className:"text-gray-500 dark:text-zinc-400",children:"Loja n√£o encontrada"}),e.jsx(j,{onClick:()=>m("/stores"),className:"mt-4",children:"Voltar para Lojas"})]})},F={delivery_base_fee:5,delivery_fee_per_km:1,delivery_free_km:2,delivery_max_fee:25,delivery_max_distance:20},_e=()=>{const{storeId:x}=G(),{storeId:m,storeSlug:N,stores:t}=te(),d=o.useMemo(()=>{if(!x)return N||m||null;const a=t.find(g=>g.id===x||g.slug===x);return a?.id||a?.slug||x},[x,N,m,t]),[u,p]=o.useState(!0),[b,y]=o.useState(!1),[r,i]=o.useState(null),[c,v]=o.useState(F),[l,h]=o.useState({name:"",email:"",phone:"",whatsapp_number:"",address:"",city:"",state:"",zip_code:"",latitude:"",longitude:""}),z=o.useCallback(async()=>{if(!d){p(!1);return}p(!0);try{const a=await re(d);i(a),h({name:a.name||"",email:a.email||"",phone:a.phone||"",whatsapp_number:a.whatsapp_number||"",address:a.address||"",city:a.city||"",state:a.state||"",zip_code:a.zip_code||"",latitude:a.latitude?.toString()||"",longitude:a.longitude?.toString()||""});const g=a.metadata||{};v({delivery_base_fee:Number(g.delivery_base_fee)||F.delivery_base_fee,delivery_fee_per_km:Number(g.delivery_fee_per_km)||F.delivery_fee_per_km,delivery_free_km:Number(g.delivery_free_km)||F.delivery_free_km,delivery_max_fee:Number(g.delivery_max_fee)||F.delivery_max_fee,delivery_max_distance:Number(g.delivery_max_distance)||F.delivery_max_distance})}catch(a){w.error("Error loading store:",a),_.error("Erro ao carregar configura√ß√µes da loja")}finally{p(!1)}},[d]);o.useEffect(()=>{z()},[z]);const s=async()=>{if(d){y(!0);try{const a={name:l.name,email:l.email,phone:l.phone,whatsapp_number:l.whatsapp_number,address:l.address,city:l.city,state:l.state,zip_code:l.zip_code};await D(d,a),_.success("Informa√ß√µes da loja atualizadas!"),z()}catch(a){w.error("Error saving store:",a),_.error("Erro ao salvar informa√ß√µes da loja")}finally{y(!1)}}},n=async()=>{if(d){y(!0);try{const g={metadata:{...r?.metadata||{},delivery_base_fee:c.delivery_base_fee,delivery_fee_per_km:c.delivery_fee_per_km,delivery_free_km:c.delivery_free_km,delivery_max_fee:c.delivery_max_fee,delivery_max_distance:c.delivery_max_distance}};await D(d,g),_.success("Configura√ß√µes de entrega atualizadas!"),z()}catch(a){w.error("Error saving delivery config:",a),_.error("Erro ao salvar configura√ß√µes de entrega")}finally{y(!1)}}},S=async()=>{if(!d)return;const a=parseFloat(l.latitude),g=parseFloat(l.longitude);if(isNaN(a)||isNaN(g)){_.error("Latitude e longitude devem ser n√∫meros v√°lidos");return}if(a<-90||a>90){_.error("Latitude deve estar entre -90 e 90");return}if(g<-180||g>180){_.error("Longitude deve estar entre -180 e 180");return}y(!0);try{const X={metadata:{...r?.metadata||{},store_latitude:a,store_longitude:g}};await D(d,X),_.success("Localiza√ß√£o da loja atualizada!"),z()}catch(L){w.error("Error saving location:",L),_.error("Erro ao salvar localiza√ß√£o")}finally{y(!1)}},P=a=>{if(a<=c.delivery_free_km)return c.delivery_base_fee;const g=a-c.delivery_free_km,L=c.delivery_base_fee+g*c.delivery_fee_per_km;return Math.min(L,c.delivery_max_fee)};return u?e.jsx("div",{className:"min-h-screen bg-gray-50 dark:bg-black flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx(le,{className:"w-8 h-8 text-gray-400 animate-spin mx-auto mb-3"}),e.jsx("p",{className:"text-gray-500 dark:text-zinc-400",children:"Carregando configura√ß√µes..."})]})}):d?e.jsx("div",{className:"min-h-screen bg-gray-50 dark:bg-black p-6",children:e.jsxs("div",{className:"max-w-6xl mx-auto space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(R,{className:"w-6 h-6 text-primary-600"}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Configura√ß√µes da Loja"}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-zinc-400",children:r?.name||"Loja"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-xl p-6 shadow-sm",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(R,{className:"w-5 h-5 text-gray-600 dark:text-zinc-300"}),e.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Informa√ß√µes da Loja"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-600 dark:text-zinc-400",children:"Nome"}),e.jsx("input",{type:"text",value:l.name,onChange:a=>h({...l,name:a.target.value}),className:"w-full mt-1 px-4 py-2 border border-gray-200 dark:border-zinc-800 rounded-lg focus:ring-2 focus:ring-primary-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-600 dark:text-zinc-400",children:"Email"}),e.jsx("input",{type:"email",value:l.email,onChange:a=>h({...l,email:a.target.value}),className:"w-full mt-1 px-4 py-2 border border-gray-200 dark:border-zinc-800 rounded-lg focus:ring-2 focus:ring-primary-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-600 dark:text-zinc-400",children:"Telefone"}),e.jsx("input",{type:"text",value:l.phone,onChange:a=>h({...l,phone:a.target.value}),className:"w-full mt-1 px-4 py-2 border border-gray-200 dark:border-zinc-800 rounded-lg focus:ring-2 focus:ring-primary-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-600 dark:text-zinc-400",children:"WhatsApp"}),e.jsx("input",{type:"text",value:l.whatsapp_number,onChange:a=>h({...l,whatsapp_number:a.target.value}),className:"w-full mt-1 px-4 py-2 border border-gray-200 dark:border-zinc-800 rounded-lg focus:ring-2 focus:ring-primary-500"})]}),e.jsx("button",{onClick:s,disabled:b,className:"w-full py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 transition-colors disabled:opacity-50",children:b?"Salvando...":"Salvar Informa√ß√µes"})]})]}),e.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-xl p-6 shadow-sm",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(ie,{className:"w-5 h-5 text-gray-600 dark:text-zinc-300"}),e.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Localiza√ß√£o"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-600 dark:text-zinc-400",children:"Endere√ßo"}),e.jsx("input",{type:"text",value:l.address,onChange:a=>h({...l,address:a.target.value}),className:"w-full mt-1 px-4 py-2 border border-gray-200 dark:border-zinc-800 rounded-lg focus:ring-2 focus:ring-primary-500"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-600 dark:text-zinc-400",children:"Cidade"}),e.jsx("input",{type:"text",value:l.city,onChange:a=>h({...l,city:a.target.value}),className:"w-full mt-1 px-4 py-2 border border-gray-200 dark:border-zinc-800 rounded-lg focus:ring-2 focus:ring-primary-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-600 dark:text-zinc-400",children:"Estado"}),e.jsx("input",{type:"text",value:l.state,onChange:a=>h({...l,state:a.target.value}),className:"w-full mt-1 px-4 py-2 border border-gray-200 dark:border-zinc-800 rounded-lg focus:ring-2 focus:ring-primary-500"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-600 dark:text-zinc-400",children:"CEP"}),e.jsx("input",{type:"text",value:l.zip_code,onChange:a=>h({...l,zip_code:a.target.value}),className:"w-full mt-1 px-4 py-2 border border-gray-200 dark:border-zinc-800 rounded-lg focus:ring-2 focus:ring-primary-500"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-600 dark:text-zinc-400",children:"Latitude"}),e.jsx("input",{type:"text",value:l.latitude,onChange:a=>h({...l,latitude:a.target.value}),className:"w-full mt-1 px-4 py-2 border border-gray-200 dark:border-zinc-800 rounded-lg focus:ring-2 focus:ring-primary-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-600 dark:text-zinc-400",children:"Longitude"}),e.jsx("input",{type:"text",value:l.longitude,onChange:a=>h({...l,longitude:a.target.value}),className:"w-full mt-1 px-4 py-2 border border-gray-200 dark:border-zinc-800 rounded-lg focus:ring-2 focus:ring-primary-500"})]})]}),e.jsx("button",{onClick:S,disabled:b,className:"w-full py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 transition-colors disabled:opacity-50",children:b?"Salvando...":"Salvar Localiza√ß√£o"})]})]})]}),e.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-xl p-6 shadow-sm",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(A,{className:"w-5 h-5 text-gray-600 dark:text-zinc-300"}),e.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Entrega"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-600 dark:text-zinc-400",children:"Taxa Base"}),e.jsx("input",{type:"number",value:c.delivery_base_fee,onChange:a=>v({...c,delivery_base_fee:parseFloat(a.target.value)}),className:"w-full mt-1 px-4 py-2 border border-gray-200 dark:border-zinc-800 rounded-lg focus:ring-2 focus:ring-primary-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-600 dark:text-zinc-400",children:"Taxa por KM"}),e.jsx("input",{type:"number",value:c.delivery_fee_per_km,onChange:a=>v({...c,delivery_fee_per_km:parseFloat(a.target.value)}),className:"w-full mt-1 px-4 py-2 border border-gray-200 dark:border-zinc-800 rounded-lg focus:ring-2 focus:ring-primary-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-600 dark:text-zinc-400",children:"KM Gr√°tis"}),e.jsx("input",{type:"number",value:c.delivery_free_km,onChange:a=>v({...c,delivery_free_km:parseFloat(a.target.value)}),className:"w-full mt-1 px-4 py-2 border border-gray-200 dark:border-zinc-800 rounded-lg focus:ring-2 focus:ring-primary-500"})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-600 dark:text-zinc-400",children:"Taxa M√°xima"}),e.jsx("input",{type:"number",value:c.delivery_max_fee,onChange:a=>v({...c,delivery_max_fee:parseFloat(a.target.value)}),className:"w-full mt-1 px-4 py-2 border border-gray-200 dark:border-zinc-800 rounded-lg focus:ring-2 focus:ring-primary-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-600 dark:text-zinc-400",children:"Dist√¢ncia M√°xima"}),e.jsx("input",{type:"number",value:c.delivery_max_distance,onChange:a=>v({...c,delivery_max_distance:parseFloat(a.target.value)}),className:"w-full mt-1 px-4 py-2 border border-gray-200 dark:border-zinc-800 rounded-lg focus:ring-2 focus:ring-primary-500"})]}),e.jsxs("div",{className:"bg-gray-50 dark:bg-black rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 text-gray-500 dark:text-zinc-400 mb-2",children:[e.jsx(de,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm font-medium",children:"Exemplo"})]}),e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{children:"5 km"}),e.jsxs("span",{className:"font-semibold",children:["R$ ",P(5).toFixed(2)]})]})]})]})]}),e.jsx("button",{onClick:n,disabled:b,className:"mt-6 w-full py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 transition-colors disabled:opacity-50",children:b?"Salvando...":"Salvar Configura√ß√µes de Entrega"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-xl p-4 shadow-sm",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(U,{className:"w-5 h-5 text-gray-500"}),e.jsx("span",{className:"text-sm text-gray-600 dark:text-zinc-400",children:"Status"})]}),e.jsx("p",{className:"text-lg font-semibold text-gray-900 dark:text-white mt-2",children:r?.status==="active"?"Ativa":"Inativa"})]}),e.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-xl p-4 shadow-sm",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(H,{className:"w-5 h-5 text-green-500"}),e.jsx("span",{className:"text-sm text-gray-600 dark:text-zinc-400",children:"Pedidos"})]}),e.jsx("p",{className:"text-lg font-semibold text-gray-900 dark:text-white mt-2",children:r?.orders_count??0})]}),e.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-xl p-4 shadow-sm",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ne,{className:"w-5 h-5 text-blue-500"}),e.jsx("span",{className:"text-sm text-gray-600 dark:text-zinc-400",children:"Produtos"})]}),e.jsx("p",{className:"text-lg font-semibold text-gray-900 dark:text-white mt-2",children:r?.products_count??0})]})]})]})}):e.jsx("div",{className:"min-h-screen bg-gray-50 dark:bg-black flex items-center justify-center",children:e.jsxs("div",{className:"text-center max-w-md",children:[e.jsx(R,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),e.jsx("p",{className:"text-gray-500 dark:text-zinc-400",children:"Selecione uma loja para configurar."})]})})};export{ke as StoreDetailPage,_e as StoreSettingsPage,Ne as StoresPage};
