const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/LoginPage-C6CkGV-l.js","assets/vendor-charts-o9Lo7m6Z.js","assets/vendor-react-C2HNIXra.js","assets/feature-automation-CLWK1V5x.js","assets/vendor-utils-DaXQUBrP.js","assets/vendor-ui-B9rDAafI.js","assets/vendor-mui-DKuE-Kg_.js","assets/feature-automation-Bw916Bj0.css","assets/DashboardPage-CrK21Zu8.js","assets/useFetch-DwL-vu9q.js","assets/AccountsPage-BFUXnc30.js","assets/AccountFormPage-B5sP40Lb.js","assets/AccountDetailPage-DsL0w641.js","assets/MessagesPage-DtR4NwQo.js","assets/ChatWindow-Bg8a9ZTJ.js","assets/ConversationsPage-DhC0iEru.js","assets/OrdersPage-CeCaW_hW.js","assets/OrderDetailPageNew-Id6N2ALC.js","assets/PaymentsPage-DqKSk0UQ.js","assets/SettingsPage-mIo1q4J6.js","assets/index-CoMg742U.js","assets/index-jrwLWn2F.js","assets/ProductsPageNew-D4kWTcK5.js","assets/feature-reports-B4FqePvs.js","assets/index-Bb3jCAeJ.js","assets/index-37FIuZc9.js","assets/marketingService-D9ImcE5m.js","assets/index-_OVmQ73D.js","assets/index-DV_E1_V-.js","assets/WhatsAppTemplatesPage-D0zb7TgF.js","assets/AutomationsPage-B8qmZ2sa.js","assets/index-DekSK43D.js","assets/Search-BWkx6N48.js","assets/index-Ba2YuiBZ.js","assets/index-D950XLqf.js"])))=>i.map(i=>d[i]);
var Be=Object.defineProperty;var Je=(t,a,r)=>a in t?Be(t,a,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[a]=r;var F=(t,a,r)=>Je(t,typeof a!="symbol"?a+"":a,r);import{j as e,c as He}from"./vendor-charts-o9Lo7m6Z.js";import{b as qe,h as Ae,r as s,N as Ke,L as Qe,O as Ge,i as Xe,j as u,k as Q,R as O,B as Ye}from"./vendor-react-C2HNIXra.js";import{b as Ze,c as et,u as D,d as ze,F as tt,e as st,f as rt,h as at,i as U,j as B,k as te,m as J,n as se,o as re,q as $,r as nt,s as ae,t as ot,v as ne,w as oe,x as ie,y as it,z as ct,A as M,B as ce,C as lt,D as le,E as Re,G as T,H as dt,I as ut,J as mt,K as V,l as W,L as de,M as ht,p as gt,N as xt,O as pt,P as ft,Q as bt,R as ue,S as m,T as Ie,U as jt,V as yt}from"./feature-automation-CLWK1V5x.js";import{c as Le,g as vt}from"./vendor-utils-DaXQUBrP.js";import{S as H,C as kt,R as me,a as _t}from"./vendor-ui-B9rDAafI.js";import"./vendor-mui-DKuE-Kg_.js";(function(){const a=document.createElement("link").relList;if(a&&a.supports&&a.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))o(n);new MutationObserver(n=>{for(const i of n)if(i.type==="childList")for(const l of i.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&o(l)}).observe(document,{childList:!0,subtree:!0});function r(n){const i={};return n.integrity&&(i.integrity=n.integrity),n.referrerPolicy&&(i.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?i.credentials="include":n.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function o(n){if(n.ep)return;n.ep=!0;const i=r(n);fetch(n.href,i)}})();var G={},he=qe;G.createRoot=he.createRoot,G.hydrateRoot=he.hydrateRoot;const wt="modulepreload",St=function(t){return"/"+t},ge={},b=function(a,r,o){let n=Promise.resolve();if(r&&r.length>0){document.getElementsByTagName("link");const l=document.querySelector("meta[property=csp-nonce]"),c=l?.nonce||l?.getAttribute("nonce");n=Promise.allSettled(r.map(h=>{if(h=St(h),h in ge)return;ge[h]=!0;const p=h.endsWith(".css"),j=p?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${h}"]${j}`))return;const k=document.createElement("link");if(k.rel=p?"stylesheet":wt,p||(k.as="script"),k.crossOrigin="",k.href=h,c&&k.setAttribute("nonce",c),document.head.appendChild(k),p)return new Promise((f,_)=>{k.addEventListener("load",f),k.addEventListener("error",()=>_(new Error(`Unable to preload CSS for ${h}`)))})}))}function i(l){const c=new Event("vite:preloadError",{cancelable:!0});if(c.payload=l,window.dispatchEvent(c),!c.defaultPrevented)throw l}return n.then(l=>{for(const c of l||[])c.status==="rejected"&&i(c.reason);return a().catch(i)})},xe={conversations:[],conversationsLoading:!1,conversationsError:null,selectedConversationId:null,messagesCache:{},messagesLoading:!1,totalUnreadCount:0,wsConnected:!1},Y=Le()(Ze((t,a)=>({...xe,setConversations:r=>{const o=r.reduce((n,i)=>n+(i.unread_count||0),0);t({conversations:r,totalUnreadCount:o,conversationsError:null})},addConversation:r=>{t(o=>o.conversations.some(i=>i.id===r.id)?o:{conversations:[r,...o.conversations],totalUnreadCount:o.totalUnreadCount+(r.unread_count||0)})},updateConversation:r=>{t(o=>{const n=o.conversations.map(l=>l.id===r.id?{...l,...r}:l),i=n.reduce((l,c)=>l+(c.unread_count||0),0);return n.sort((l,c)=>{const h=l.last_message_at?new Date(l.last_message_at).getTime():0;return(c.last_message_at?new Date(c.last_message_at).getTime():0)-h}),{conversations:n,totalUnreadCount:i}})},removeConversation:r=>{t(o=>{const n=o.conversations.find(l=>l.id===r),i=o.totalUnreadCount-(n?.unread_count||0);return{conversations:o.conversations.filter(l=>l.id!==r),totalUnreadCount:Math.max(0,i),selectedConversationId:o.selectedConversationId===r?null:o.selectedConversationId}})},setSelectedConversation:r=>{t({selectedConversationId:r})},setMessages:(r,o)=>{t(n=>({messagesCache:{...n.messagesCache,[r]:o}}))},addMessage:(r,o)=>{t(n=>{const i=n.messagesCache[r]||[];return i.some(c=>c.id===o.id||c.whatsapp_message_id&&c.whatsapp_message_id===o.whatsapp_message_id)?n:{messagesCache:{...n.messagesCache,[r]:[...i,o]}}})},updateMessage:(r,o,n)=>{t(i=>{const l=i.messagesCache[r];return l?{messagesCache:{...i.messagesCache,[r]:l.map(c=>c.id===o?{...c,...n}:c)}}:i})},updateMessageStatus:(r,o,n)=>{t(i=>{const l={...i.messagesCache};for(const c of Object.keys(l)){const h=l[c],p=h.findIndex(j=>j.id===r||j.whatsapp_message_id===r);if(p!==-1){l[c]=h.map((j,k)=>{if(k===p){const f={status:o};return o==="delivered"&&n&&(f.delivered_at=n),o==="read"&&n&&(f.read_at=n),{...j,...f}}return j});break}}return{messagesCache:l}})},markConversationAsRead:r=>{t(o=>{const n=o.conversations.find(i=>i.id===r);return!n||n.unread_count===0?o:{conversations:o.conversations.map(i=>i.id===r?{...i,unread_count:0}:i),totalUnreadCount:Math.max(0,o.totalUnreadCount-(n.unread_count||0))}})},incrementUnreadCount:r=>{t(o=>({conversations:o.conversations.map(n=>n.id===r?{...n,unread_count:(n.unread_count||0)+1}:n),totalUnreadCount:o.totalUnreadCount+1}))},setWsConnected:r=>t({wsConnected:r}),setConversationsLoading:r=>t({conversationsLoading:r}),setMessagesLoading:r=>t({messagesLoading:r}),setConversationsError:r=>t({conversationsError:r}),getSelectedConversation:()=>{const r=a();return r.conversations.find(o=>o.id===r.selectedConversationId)||null},getConversationMessages:r=>a().messagesCache[r]||[],reset:()=>t(xe)}),{name:"pastita-chat-store",storage:et(()=>sessionStorage),partialize:t=>({selectedConversationId:t.selectedConversationId})})),Ct=()=>Y(t=>t.totalUnreadCount),Nt=()=>Y(t=>t.wsConnected),pe=({onClose:t})=>{const{logout:a,user:r}=D(),{store:o}=ze(),n=Ae(),[i,l]=s.useState([]),[c,h]=s.useState(""),p=Ct();Nt();const j=o?.slug||o?.id||null,k=j?`/stores/${j}`:"/stores",f=s.useMemo(()=>d=>j?`${k}/${d}`:"/stores",[j,k]),_=s.useMemo(()=>[{title:"Principal",items:[{name:"Dashboard",href:"/",icon:tt},{name:"Pedidos",href:f("orders"),icon:st},{name:"Produtos",href:f("products"),icon:rt},{name:"Cupons",href:f("coupons"),icon:at}]},{title:"ComunicaÃ§Ã£o",items:[{name:"Conversas",href:"/conversations",icon:U,badge:p>0?String(p):void 0},{name:"WhatsApp",href:"/whatsapp/chat",icon:B,children:[{name:"Chat",href:"/whatsapp/chat",icon:U},{name:"Contas",href:"/accounts",icon:B},{name:"Templates",href:"/marketing/whatsapp/templates",icon:te},{name:"Analytics",href:"/analytics",icon:J},{name:"DiagnÃ³stico",href:"/whatsapp/diagnostics",icon:se}]},{name:"Instagram",href:"/instagram/inbox",icon:U,children:[{name:"Mensagens",href:"/instagram/inbox",icon:re},{name:"Contas",href:"/instagram/accounts",icon:$}]},{name:"Messenger",href:"/messenger/inbox",icon:nt,children:[{name:"Mensagens",href:"/messenger/inbox",icon:re},{name:"Contas",href:"/messenger/accounts",icon:$}]},{name:"Marketing",href:"/marketing",icon:ae,children:[{name:"Dashboard",href:"/marketing",icon:ae},{name:"Campanhas Email",href:"/marketing/email/campaigns",icon:ot},{name:"Campanhas WhatsApp",href:"/marketing/whatsapp",icon:B},{name:"Templates",href:"/marketing/whatsapp/templates",icon:te},{name:"Assinantes",href:"/marketing/subscribers",icon:$},{name:"AutomaÃ§Ãµes",href:"/marketing/automations",icon:ne}]}]},{title:"AutomaÃ§Ã£o & IA",items:[{name:"Agentes IA",href:"/agents",icon:oe,badge:"Novo",children:[{name:"Lista de Agentes",href:"/agents",icon:oe},{name:"Testar Orquestrador",href:"/agents/test/orchestrator",icon:ie}]},{name:"AutomaÃ§Ã£o",href:"/automation/companies",icon:ne,children:[{name:"Empresas",href:"/automation/companies",icon:it},{name:"SessÃµes Clientes",href:"/automation/sessions",icon:$},{name:"Agendamentos",href:"/automation/scheduled",icon:ct},{name:"Logs",href:"/automation/logs",icon:M},{name:"RelatÃ³rios",href:"/automation/reports",icon:M}]},{name:"IntenÃ§Ãµes (Novo)",href:"/automation/intents",icon:ie,badge:"Novo",children:[{name:"EstatÃ­sticas",href:"/automation/intents",icon:J},{name:"Logs de IntenÃ§Ãµes",href:"/automation/intents/logs",icon:M}]}]},{title:"Analytics & Dados",items:[{name:"Analytics",href:f("analytics"),icon:J},{name:"RelatÃ³rios",href:"/reports",icon:M},{name:"Lojas",href:"/stores",icon:ce,children:[{name:"Todas Lojas",href:"/stores",icon:ce},{name:"ConfiguraÃ§Ãµes",href:f("settings"),icon:se},{name:"Pagamentos",href:f("payments"),icon:lt}]}]}],[f,p]),E=s.useMemo(()=>{if(!c.trim())return _;const d=c.toLowerCase();return _.map(x=>({...x,items:x.items.filter(w=>w.name.toLowerCase().includes(d)||w.children?.some(A=>A.name.toLowerCase().includes(d)))})).filter(x=>x.items.length>0)},[_,c]),y=s.useMemo(()=>{const d={name:"Pastita",logo:"/pastita-logo.svg",primaryColor:"#722F37",secondaryColor:"#8B3A42",initial:"P"};if(!o)return d;if(o.name?.toLowerCase().includes("agriao")||o.slug?.toLowerCase().includes("agriao"))return{name:o.name||"AgriÃ£o",logo:o.logo_url||null,primaryColor:"#4A5D23",secondaryColor:"#6B8E23",initial:"A"};const w=o.name?.toLowerCase().includes("pastita")||o.slug?.toLowerCase().includes("pastita");return{name:o.name||"Pastita",logo:w?"/pastita-logo.svg":o.logo_url||null,primaryColor:o.primary_color||"#722F37",secondaryColor:o.secondary_color||"#8B3A42",initial:o.name?.[0]?.toUpperCase()||"P"}},[o]);s.useEffect(()=>{o?.name?.toLowerCase().includes("agriao")||o?.slug?.toLowerCase().includes("agriao")?document.documentElement.setAttribute("data-theme","agriao"):document.documentElement.removeAttribute("data-theme")},[o]);const g=()=>{a(),window.location.href="/login"},N=()=>{t&&t()},v=d=>{l(x=>x.includes(d)?x.filter(w=>w!==d):[...x,d])},P=d=>n.pathname===d.href?!0:d.children?d.children.some(x=>n.pathname.startsWith(x.href)):!1,R=(d,x=0)=>{const w=d.children&&d.children.length>0,A=i.includes(d.name),I=P(d);return w?e.jsxs("div",{children:[e.jsxs("button",{onClick:()=>v(d.name),className:`w-full flex items-center justify-between px-3 py-2 text-sm font-medium rounded-lg transition-colors ${I?"bg-primary-50 dark:bg-zinc-900 text-primary-700 dark:text-primary-400":"text-gray-700 dark:text-zinc-300 hover:bg-gray-100 dark:hover:bg-zinc-800"}`,children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(d.icon,{className:"w-5 h-5 mr-3"}),d.name]}),e.jsxs("div",{className:"flex items-center gap-1",children:[d.badge&&e.jsx("span",{className:"text-xs bg-primary-100 dark:bg-zinc-800 text-primary-700 dark:text-primary-400 px-1.5 py-0.5 rounded",children:d.badge}),A?e.jsx(ut,{className:"w-4 h-4"}):e.jsx(mt,{className:"w-4 h-4"})]})]}),A&&e.jsx("div",{className:"ml-4 mt-1 space-y-1 border-l-2 border-gray-100 dark:border-zinc-800 pl-2",children:d.children.map(C=>R(C,x+1))})]},d.name):e.jsxs(Ke,{to:d.href,end:d.href==="/",onClick:N,className:({isActive:C})=>`flex items-center justify-between px-3 py-2 text-sm font-medium rounded-lg transition-colors ${C?"bg-primary-50 dark:bg-zinc-900 text-primary-700 dark:text-primary-400":"text-gray-700 dark:text-zinc-300 hover:bg-gray-100 dark:hover:bg-zinc-800"}`,children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(d.icon,{className:"w-5 h-5 mr-3"}),d.name]}),d.badge&&e.jsx("span",{className:"text-xs bg-primary-100 dark:bg-zinc-800 text-primary-700 dark:text-primary-400 px-1.5 py-0.5 rounded",children:d.badge})]},d.name)};return e.jsxs("div",{className:"flex flex-col h-full bg-white dark:bg-black border-r border-gray-200 dark:border-zinc-800 w-64 transition-colors",children:[e.jsxs("div",{className:"flex items-center justify-between h-16 px-6 border-b border-gray-200 dark:border-zinc-800",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[y.logo?e.jsx("img",{src:y.logo,alt:y.name,className:"w-10 h-10 rounded-xl object-cover shadow-sm",onError:d=>{d.currentTarget.style.display="none",d.currentTarget.nextElementSibling?.classList.remove("hidden")}}):null,e.jsx("div",{className:`w-10 h-10 rounded-xl flex items-center justify-center shadow-sm transition-all duration-300 ${y.logo?"hidden":""}`,style:{background:`linear-gradient(135deg, ${y.primaryColor} 0%, ${y.secondaryColor} 100%)`},children:e.jsx("span",{className:"text-white font-bold text-lg",children:y.initial})}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"font-bold text-gray-900 dark:text-white text-lg leading-tight truncate max-w-[120px]",children:y.name}),e.jsx("span",{className:"text-xs text-gray-500 dark:text-zinc-400",children:"Dashboard"})]})]}),t&&e.jsx("button",{onClick:t,className:"p-1.5 text-gray-400 hover:text-gray-600 dark:hover:text-zinc-300 hover:bg-gray-100 dark:hover:bg-zinc-800 rounded-lg lg:hidden transition-colors",children:e.jsx(le,{className:"w-5 h-5"})})]}),e.jsx("div",{className:"px-3 py-2",children:e.jsxs("div",{className:"relative",children:[e.jsx(Re,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400 dark:text-zinc-500"}),e.jsx("input",{type:"text",placeholder:"Buscar menu...",value:c,onChange:d=>h(d.target.value),className:T("w-full pl-9 pr-3 py-2 text-sm","bg-gray-50 dark:bg-zinc-900 border border-gray-200 dark:border-zinc-800","rounded-lg placeholder-gray-400 dark:placeholder-zinc-500","text-gray-900 dark:text-zinc-100","focus:outline-none focus:ring-2 focus:ring-primary-500/20 focus:border-primary-500","transition-all duration-200")}),c&&e.jsx("button",{onClick:()=>h(""),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600 dark:hover:text-zinc-300",children:e.jsx(le,{className:"w-4 h-4"})})]})}),e.jsxs("nav",{className:"flex-1 px-3 py-2 overflow-y-auto smooth-scroll",children:[E.map((d,x)=>e.jsxs("div",{className:T("animate-fade-up",x>0?"mt-5":""),children:[e.jsx("h3",{className:"px-3 mb-2 text-[10px] font-semibold text-gray-400 dark:text-zinc-500 uppercase tracking-wider",children:d.title}),e.jsx("div",{className:"space-y-0.5",children:d.items.map(w=>R(w))})]},d.title)),E.length===0&&c&&e.jsx("div",{className:"px-3 py-8 text-center",children:e.jsx("p",{className:"text-sm text-gray-500 dark:text-zinc-400",children:"Nenhum item encontrado"})})]}),e.jsx("div",{className:"p-4 border-t border-gray-200 dark:border-zinc-800",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-8 h-8 bg-primary-100 dark:bg-zinc-800 rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-sm font-medium text-primary-700 dark:text-primary-400",children:r?.first_name?.[0]||r?.username?.[0]||"U"})}),e.jsxs("div",{className:"ml-3",children:[e.jsx("p",{className:"text-sm font-medium text-gray-900 dark:text-white",children:r?.first_name||r?.username||"UsuÃ¡rio"}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-zinc-400 truncate max-w-[120px]",children:r?.email})]})]}),e.jsx("button",{onClick:g,className:"p-2 text-gray-400 hover:text-gray-600 dark:hover:text-zinc-300 rounded-lg hover:bg-gray-100 dark:hover:bg-zinc-800 transition-colors",title:"Sair",children:e.jsx(dt,{className:"w-5 h-5"})})]})})]})},Z=Le(t=>({accounts:[],selectedAccount:null,isLoading:!1,setAccounts:a=>t({accounts:a}),setSelectedAccount:a=>t({selectedAccount:a}),setLoading:a=>t({isLoading:a}),updateAccount:a=>t(r=>({accounts:r.accounts.map(o=>o.id===a.id?a:o),selectedAccount:r.selectedAccount?.id===a.id?a:r.selectedAccount})),removeAccount:a=>t(r=>({accounts:r.accounts.filter(o=>o.id!==a),selectedAccount:r.selectedAccount?.id===a?null:r.selectedAccount}))})),Et="pastita",Te=s.createContext(null);function Pt({children:t}){const{token:a}=D(),{storeSlug:r,storeId:o}=ze(),n=s.useRef(null),i=s.useRef(new Map),l=s.useRef(void 0),c=s.useRef(void 0),h=s.useRef(0),p=s.useRef(!1),[j,k]=s.useState(!1),[f,_]=s.useState(null),E=r||o||Et,y=s.useCallback((v,P)=>{const R=i.current.get(v),d=i.current.get("*");console.log(`[WS] Event: ${v}`,P),console.log(`[WS] Listeners for '${v}':`,R?.size||0),R?.forEach(x=>{try{x(P)}catch(w){console.error("[WS] Callback error:",w)}}),d?.forEach(x=>{try{x(P)}catch(w){console.error("[WS] Wildcard callback error:",w)}})},[]),g=s.useCallback(()=>{let v=a;if(!v&&typeof window<"u")try{const x=window.localStorage.getItem("auth-storage");x&&(v=JSON.parse(x)?.state?.token||void 0,v&&console.debug("[WS] using token from localStorage"))}catch{}if(!v){console.log("[WS] No token, skipping connection");return}if(p.current){console.log("[WS] Already connecting, skipping");return}if(n.current?.readyState===WebSocket.OPEN){console.log("[WS] Already connected");return}n.current&&(n.current.onclose=null,n.current.close(),n.current=null),p.current=!0;let P;P||(P=window.location.host);const d=`${P.includes("railway")||P.includes("vercel")||location.protocol==="https:"?"wss":"ws"}://${P}/ws/stores/${E}/orders/?token=${v}`;console.log("[WS] Connecting to:",d.replace(/token=.*/,"token=***"));try{const x=new WebSocket(d);n.current=x,x.onopen=()=>{console.log("[WS] Connected âœ“"),p.current=!1,k(!0),_(null),h.current=0,c.current&&window.clearInterval(c.current),c.current=window.setInterval(()=>{x.readyState===WebSocket.OPEN&&x.send('{"type":"ping"}')},25e3)},x.onmessage=w=>{try{const A=JSON.parse(w.data);if(A.type==="pong")return;if(A.type==="connection_established"){console.log("[WS] Server confirmed connection");return}const C={"order.created":"order_created","order.updated":"order_updated","order.paid":"payment_received","order.cancelled":"order_cancelled"}[A.type]||A.type;y(C,A)}catch(A){console.error("[WS] Parse error:",A)}},x.onclose=w=>{if(console.log("[WS] Closed:",w.code,w.reason),p.current=!1,k(!1),c.current&&(window.clearInterval(c.current),c.current=void 0),w.code!==1e3&&h.current<10){const A=Math.min(1e3*Math.pow(1.5,h.current),3e4);console.log(`[WS] Reconnecting in ${Math.round(A)}ms (attempt ${h.current+1}/10)`),_("Reconectando..."),l.current=window.setTimeout(()=>{h.current++,g()},A)}else h.current>=10&&_("ConexÃ£o perdida. Atualize a pÃ¡gina.")},x.onerror=w=>{console.error("[WS] Error:",w),p.current=!1}}catch(x){console.error("[WS] Connection error:",x),p.current=!1}},[a,y,E]),N=s.useCallback((v,P)=>(i.current.has(v)||i.current.set(v,new Set),i.current.get(v).add(P),console.log(`[WS] Subscribed to '${v}' (total: ${i.current.get(v).size})`),()=>{i.current.get(v)?.delete(P),console.log(`[WS] Unsubscribed from '${v}'`)}),[]);return s.useEffect(()=>{g();const v=()=>{document.visibilityState==="visible"&&(!n.current||n.current.readyState!==WebSocket.OPEN)&&(console.log("[WS] Tab visible, reconnecting..."),h.current=0,g())};return document.addEventListener("visibilitychange",v),()=>{document.removeEventListener("visibilitychange",v),l.current&&window.clearTimeout(l.current),c.current&&window.clearInterval(c.current),n.current&&(n.current.onclose=null,n.current.close(1e3))}},[g]),e.jsx(Te.Provider,{value:{isConnected:j,error:f,on:N},children:t})}function At(){const t=s.useContext(Te);if(!t)throw new Error("useWS must be inside WebSocketProvider");return t}const zt=()=>{const[t,a]=s.useState(!1),[r,o]=s.useState([]),[n,i]=s.useState(0),[l,c]=s.useState(!1),h=s.useRef(null),{isConnected:p,on:j}=At(),k=s.useCallback(async()=>{c(!0);try{const g=await V.getNotifications();o(g.results)}catch(g){W.error("Error loading notifications:",g)}finally{c(!1)}},[]),f=s.useCallback(async()=>{try{const g=await V.getUnreadCount();i(g.count)}catch(g){W.error("Error loading unread count:",g)}},[]);s.useEffect(()=>{k(),f()},[k,f]),s.useEffect(()=>{const g=j("order_created",()=>{i(N=>N+1),setTimeout(()=>k(),1e3)});return()=>{g()}},[j,k]),s.useEffect(()=>{const g=N=>{h.current&&!h.current.contains(N.target)&&a(!1)};return document.addEventListener("mousedown",g),()=>document.removeEventListener("mousedown",g)},[]);const _=async()=>{try{await V.markAsRead(void 0,!0),o(g=>g.map(N=>({...N,is_read:!0,read_at:new Date().toISOString()}))),i(0)}catch(g){W.error("Error marking all as read:",g)}},E=async g=>{try{await V.markAsRead([g]),o(N=>N.map(v=>v.id===g?{...v,is_read:!0,read_at:new Date().toISOString()}:v)),i(N=>Math.max(0,N-1))}catch(N){W.error("Error marking as read:",N)}},y=g=>{switch(g){case"message":return"ðŸ’¬";case"order":return"ðŸ“¦";case"payment":return"ðŸ’³";case"conversation":return"ðŸ‘¤";case"alert":return"âš ï¸";default:return"ðŸ””"}};return e.jsxs("div",{className:"relative",ref:h,children:[e.jsxs("button",{onClick:()=>a(!t),className:"relative p-2 text-gray-600 dark:text-zinc-400 hover:text-gray-900 dark:hover:text-gray-100 hover:bg-gray-100 dark:hover:bg-zinc-700 rounded-full transition-colors",children:[e.jsx(de,{className:"w-6 h-6"}),n>0&&e.jsx("span",{className:"absolute top-0 right-0 inline-flex items-center justify-center px-2 py-1 text-xs font-bold leading-none text-white transform translate-x-1/2 -translate-y-1/2 bg-red-500 rounded-full",children:n>99?"99+":n})]}),t&&e.jsxs("div",{className:"absolute right-0 mt-2 w-96 bg-white dark:bg-zinc-900 rounded-lg shadow-lg border border-gray-200 dark:border-zinc-800 z-50",children:[e.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b border-gray-200 dark:border-zinc-800",children:[e.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white",children:"NotificaÃ§Ãµes"}),n>0&&e.jsxs("button",{onClick:_,className:"text-sm text-primary-600 dark:text-primary-400 hover:text-primary-700 dark:hover:text-primary-300 flex items-center gap-1",children:[e.jsx(ht,{className:"w-4 h-4"}),"Marcar todas como lidas"]})]}),e.jsx("div",{className:"max-h-96 overflow-y-auto",children:l?e.jsx("div",{className:"p-4 text-center text-gray-500 dark:text-zinc-400",children:"Carregando..."}):r.length===0?e.jsxs("div",{className:"p-8 text-center text-gray-500 dark:text-zinc-400",children:[e.jsx(de,{className:"w-12 h-12 mx-auto mb-2 text-gray-300 dark:text-gray-600"}),e.jsx("p",{children:"Nenhuma notificaÃ§Ã£o"})]}):r.map(g=>e.jsx("div",{className:`px-4 py-3 border-b border-gray-100 dark:border-zinc-800 hover:bg-gray-50 dark:hover:bg-zinc-700 cursor-pointer transition-colors ${g.is_read?"":"bg-primary-50 dark:bg-primary-900/30"}`,onClick:()=>!g.is_read&&E(g.id),children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("span",{className:"text-xl",children:y(g.notification_type)}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-medium text-gray-900 dark:text-white truncate",children:g.title}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-zinc-400 line-clamp-2",children:g.message}),e.jsx("p",{className:"text-xs text-gray-400 dark:text-gray-500 mt-1",children:vt(new Date(g.created_at),"dd/MM 'Ã s' HH:mm",{locale:gt})})]}),!g.is_read&&e.jsx("span",{className:"w-2 h-2 bg-primary-500 rounded-full flex-shrink-0 mt-2"})]})},g.id))}),e.jsx("div",{className:"px-4 py-3 border-t border-gray-200 dark:border-zinc-800",children:e.jsx("button",{onClick:()=>{a(!1)},className:"text-sm text-primary-600 dark:text-primary-400 hover:text-primary-700 dark:hover:text-primary-300 w-full text-center",children:"Ver todas as notificaÃ§Ãµes"})})]})]})},Rt=()=>{const{stores:t,selectedStore:a,loading:r,error:o,initialized:n,fetchStores:i,setSelectedStore:l}=xt();return s.useEffect(()=>{n||i()},[n,i]),r&&!n?e.jsxs("div",{className:"flex items-center gap-2 px-3 py-2 bg-gray-100 dark:bg-gray-700 rounded-lg animate-pulse",children:[e.jsx(H,{className:"w-4 h-4 text-gray-400 dark:text-gray-500"}),e.jsx("div",{className:"w-32 h-4 bg-gray-200 dark:bg-gray-600 rounded"})]}):o&&t.length===0?e.jsxs("div",{className:"flex items-center gap-2 px-3 py-2 bg-red-50 dark:bg-red-900/30 text-red-600 dark:text-red-400 rounded-lg",children:[e.jsx(kt,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm",children:"Erro ao carregar lojas"}),e.jsx("button",{onClick:()=>i(),className:"p-1 hover:bg-red-100 dark:hover:bg-red-900/50 rounded",title:"Tentar novamente",children:e.jsx(me,{className:"w-3 h-3"})})]}):t.length===0?e.jsxs("div",{className:"flex items-center gap-2 px-3 py-2 bg-yellow-50 dark:bg-yellow-900/30 text-yellow-700 dark:text-yellow-400 rounded-lg",children:[e.jsx(H,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm",children:"Nenhuma loja disponÃ­vel"})]}):e.jsxs("div",{className:"relative flex items-center gap-2",children:[e.jsx(H,{className:"w-4 h-4 text-gray-500 dark:text-zinc-400"}),e.jsxs("div",{className:"relative",children:[e.jsx("select",{value:a?.id||"",onChange:c=>{const h=t.find(p=>p.id===c.target.value);l(h||null)},className:"appearance-none bg-white dark:bg-zinc-900 border border-gray-200 dark:border-zinc-700 rounded-lg px-3 py-1.5 pr-8 text-sm font-medium text-gray-700 dark:text-zinc-300 hover:border-gray-300 dark:hover:border-gray-500 focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent cursor-pointer min-w-[180px] transition-colors",disabled:r,children:t.map(c=>e.jsx("option",{value:c.id,children:c.name},c.id))}),e.jsx(_t,{className:"absolute right-2 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400 dark:text-gray-500 pointer-events-none"})]}),e.jsx("button",{onClick:()=>i(),disabled:r,className:`p-1.5 rounded-lg hover:bg-gray-100 dark:hover:bg-zinc-700 transition-colors ${r?"animate-spin":""}`,title:"Atualizar lojas",children:e.jsx(me,{className:"w-4 h-4 text-gray-400 dark:text-gray-500"})}),a&&e.jsx("div",{className:`w-2 h-2 rounded-full ${a.status==="active"?"bg-green-500":a.status==="inactive"?"bg-gray-400":a.status==="suspended"?"bg-red-500":"bg-yellow-500"}`,title:`Status: ${a.status}`})]})};var It=(t,a,r,o,n,i,l,c)=>{let h=document.documentElement,p=["light","dark"];function j(_){(Array.isArray(t)?t:[t]).forEach(E=>{let y=E==="class",g=y&&i?n.map(N=>i[N]||N):n;y?(h.classList.remove(...g),h.classList.add(i&&i[_]?i[_]:_)):h.setAttribute(E,_)}),k(_)}function k(_){c&&p.includes(_)&&(h.style.colorScheme=_)}function f(){return window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"}if(o)j(o);else try{let _=localStorage.getItem(a)||r,E=l&&_==="system"?f():_;j(E)}catch{}},fe=["light","dark"],Oe="(prefers-color-scheme: dark)",Lt=typeof window>"u",ee=s.createContext(void 0),Tt={setTheme:t=>{},themes:[]},Ot=()=>{var t;return(t=s.useContext(ee))!=null?t:Tt},Dt=t=>s.useContext(ee)?s.createElement(s.Fragment,null,t.children):s.createElement($t,{...t}),Wt=["light","dark"],$t=({forcedTheme:t,disableTransitionOnChange:a=!1,enableSystem:r=!0,enableColorScheme:o=!0,storageKey:n="theme",themes:i=Wt,defaultTheme:l=r?"system":"light",attribute:c="data-theme",value:h,children:p,nonce:j,scriptProps:k})=>{let[f,_]=s.useState(()=>Vt(n,l)),[E,y]=s.useState(()=>f==="system"?q():f),g=h?Object.values(h):i,N=s.useCallback(d=>{let x=d;if(!x)return;d==="system"&&r&&(x=q());let w=h?h[x]:x,A=a?Ft(j):null,I=document.documentElement,C=S=>{S==="class"?(I.classList.remove(...g),w&&I.classList.add(w)):S.startsWith("data-")&&(w?I.setAttribute(S,w):I.removeAttribute(S))};if(Array.isArray(c)?c.forEach(C):C(c),o){let S=fe.includes(l)?l:null,z=fe.includes(x)?x:S;I.style.colorScheme=z}A?.()},[j]),v=s.useCallback(d=>{let x=typeof d=="function"?d(f):d;_(x);try{localStorage.setItem(n,x)}catch{}},[f]),P=s.useCallback(d=>{let x=q(d);y(x),f==="system"&&r&&!t&&N("system")},[f,t]);s.useEffect(()=>{let d=window.matchMedia(Oe);return d.addListener(P),P(d),()=>d.removeListener(P)},[P]),s.useEffect(()=>{let d=x=>{x.key===n&&(x.newValue?_(x.newValue):v(l))};return window.addEventListener("storage",d),()=>window.removeEventListener("storage",d)},[v]),s.useEffect(()=>{N(t??f)},[t,f]);let R=s.useMemo(()=>({theme:f,setTheme:v,forcedTheme:t,resolvedTheme:f==="system"?E:f,themes:r?[...i,"system"]:i,systemTheme:r?E:void 0}),[f,v,t,E,r,i]);return s.createElement(ee.Provider,{value:R},s.createElement(Mt,{forcedTheme:t,storageKey:n,attribute:c,enableSystem:r,enableColorScheme:o,defaultTheme:l,value:h,themes:i,nonce:j,scriptProps:k}),p)},Mt=s.memo(({forcedTheme:t,storageKey:a,attribute:r,enableSystem:o,enableColorScheme:n,defaultTheme:i,value:l,themes:c,nonce:h,scriptProps:p})=>{let j=JSON.stringify([r,a,i,t,c,l,o,n]).slice(1,-1);return s.createElement("script",{...p,suppressHydrationWarning:!0,nonce:typeof window>"u"?h:"",dangerouslySetInnerHTML:{__html:`(${It.toString()})(${j})`}})}),Vt=(t,a)=>{if(Lt)return;let r;try{r=localStorage.getItem(t)||void 0}catch{}return r||a},Ft=t=>{let a=document.createElement("style");return t&&a.setAttribute("nonce",t),a.appendChild(document.createTextNode("*,*::before,*::after{-webkit-transition:none!important;-moz-transition:none!important;-o-transition:none!important;-ms-transition:none!important;transition:none!important}")),document.head.appendChild(a),()=>{window.getComputedStyle(document.body),setTimeout(()=>{document.head.removeChild(a)},1)}},q=t=>(t||(t=window.matchMedia(Oe)),t.matches?"dark":"light");function Ut({children:t,...a}){return e.jsx(Dt,{attribute:"class",defaultTheme:"system",enableSystem:!0,disableTransitionOnChange:!1,...a,children:t})}function Bt(){const{theme:t,setTheme:a,resolvedTheme:r,systemTheme:o}=Ot(),[n,i]=s.useState(!1);return s.useEffect(()=>{i(!0)},[]),{theme:t,setTheme:a,resolvedTheme:r,systemTheme:o,isDark:r==="dark",isLight:r==="light",toggle:()=>a(r==="dark"?"light":"dark"),mounted:n}}function Jt(){const{isDark:t,toggle:a,mounted:r}=Bt();return r?e.jsx("button",{onClick:a,className:"p-2 rounded-lg bg-zinc-200 hover:bg-zinc-300 dark:bg-zinc-800 dark:hover:bg-zinc-700 transition-colors","aria-label":t?"Ativar modo claro":"Ativar modo escuro",children:t?e.jsx(pt,{className:"w-5 h-5 text-yellow-400"}):e.jsx(ft,{className:"w-5 h-5 text-zinc-600"})}):e.jsx("button",{className:"p-2 rounded-lg bg-zinc-200 dark:bg-zinc-800 transition-colors","aria-label":"Carregando tema",children:e.jsx("div",{className:"w-5 h-5"})})}const be={analytics:"Analytics",accounts:"Contas",agents:"Agentes IA",automation:"AutomaÃ§Ã£o",campaigns:"Campanhas",conversations:"Conversas",dashboard:"Dashboard",delivery:"Entrega",instagram:"Instagram",marketing:"Marketing",messages:"Mensagens",messenger:"Messenger",payments:"Pagamentos",products:"Produtos",reports:"RelatÃ³rios",settings:"ConfiguraÃ§Ãµes",stores:"Lojas",orders:"Pedidos",whatsapp:"WhatsApp"},Ht=/^[0-9a-f]{4,}-[0-9a-f]{2,}-[0-9a-f]{2,}/i,qt=t=>t.replace(/-/g," ").replace(/\b\w/g,a=>a.toUpperCase()),Kt=t=>{if(!t)return"Dashboard";const a=t.toLowerCase();return be[a]?be[a]:/^\d+$/.test(t)||Ht.test(t)?"Detalhes":qt(t)},Qt=t=>{const a=t.split("/").filter(Boolean),r=[{label:"Dashboard",path:"/"}];return a.forEach((o,n)=>{r.push({label:Kt(o),path:`/${a.slice(0,n+1).join("/")}`})}),r},Gt=({title:t="Painel",subtitle:a,actions:r,showSearch:o=!0,showStoreSelector:n=!0,onSearch:i,onMenuClick:l})=>{const{accounts:c,selectedAccount:h,setSelectedAccount:p}=Z(),[j,k]=s.useState(""),f=Ae(),_=s.useMemo(()=>Qt(f.pathname),[f.pathname]),E=y=>{y.preventDefault(),i?.(j)};return e.jsx("header",{className:"border-b border-gray-200 dark:border-zinc-800 bg-white dark:bg-black px-4 md:px-6 py-4 transition-colors",children:e.jsxs("div",{className:"flex flex-col gap-4 md:flex-row md:items-center md:justify-between",children:[e.jsxs("div",{className:"flex w-full items-start gap-4 md:items-center",children:[l&&e.jsx("button",{onClick:l,className:"lg:hidden rounded-lg border border-gray-200 bg-white/70 p-2 text-gray-600 transition hover:border-gray-300 hover:text-gray-900 dark:border-zinc-700 dark:bg-zinc-900/60 dark:text-zinc-300 dark:hover:border-zinc-600 dark:hover:text-white",children:e.jsx(bt,{className:"h-6 w-6"})}),e.jsxs("div",{className:"flex flex-1 flex-col gap-1 min-w-0",children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[e.jsx("h1",{className:"text-xl font-bold text-gray-900 dark:text-white",children:t}),a&&e.jsx("p",{className:"text-sm text-gray-500 dark:text-zinc-400",children:a})]}),e.jsx("nav",{"aria-label":"Breadcrumb",className:"mt-1",children:e.jsx("ol",{className:"flex flex-wrap items-center gap-2 text-xs font-medium text-gray-500 dark:text-zinc-400",children:_.map((y,g)=>{const N=g===_.length-1;return e.jsxs("li",{className:"flex items-center gap-1",children:[N?e.jsx("span",{className:"text-gray-900 dark:text-white",children:y.label}):e.jsx(Qe,{to:y.path,className:"hover:text-gray-900 dark:hover:text-white",children:y.label}),g<_.length-1&&e.jsx("span",{"aria-hidden":"true",children:"/"})]},`${y.path}-${g}`)})})})]})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[n&&e.jsx(Rt,{}),c.length>0&&e.jsxs("select",{value:h?.id||"",onChange:y=>{const g=c.find(N=>N.id===y.target.value);p(g||null)},className:"rounded-lg border border-gray-300 bg-white px-3 py-2 text-sm text-gray-900 outline-none transition focus:border-[#722F37] focus:ring-2 focus:ring-[#722F37] focus:ring-offset-0 dark:border-zinc-700 dark:bg-zinc-900 dark:text-zinc-100",children:[e.jsx("option",{value:"",children:"Todas as contas"}),c.map(y=>e.jsx("option",{value:y.id,children:y.name},y.id))]}),o&&e.jsxs("form",{onSubmit:E,className:"relative hidden min-w-[220px] sm:block",children:[e.jsx(Re,{className:"absolute left-3 top-1/2 h-5 w-5 -translate-y-1/2 text-gray-400 dark:text-zinc-500"}),e.jsx("input",{type:"text",placeholder:"Buscar...",value:j,onChange:y=>k(y.target.value),className:"w-full rounded-lg border border-gray-300 bg-white py-2 pl-10 pr-4 text-sm text-gray-900 placeholder-gray-400 outline-none transition focus:border-[#722F37] focus:ring-2 focus:ring-[#722F37]/30 dark:border-zinc-700 dark:bg-zinc-900 dark:text-zinc-100"})]}),e.jsx(Jt,{}),e.jsx(zt,{}),r]})]})})},Xt=()=>{const[t,a]=s.useState(!1);return e.jsxs("div",{className:"flex min-h-screen overflow-hidden bg-white dark:bg-black text-gray-900 dark:text-white transition-colors duration-300",children:[t&&e.jsx("div",{className:"fixed inset-0 z-30 bg-black/60 lg:hidden",onClick:()=>a(!1)}),e.jsx("div",{className:`fixed inset-y-0 left-0 z-40 w-72 transform transition-transform duration-300 ease-in-out lg:hidden ${t?"translate-x-0":"-translate-x-full"}`,children:e.jsx(pe,{onClose:()=>a(!1)})}),e.jsx("div",{className:"hidden lg:flex lg:w-72 lg:flex-shrink-0",children:e.jsx(pe,{})}),e.jsxs("div",{className:"flex flex-1 flex-col overflow-hidden",children:[e.jsx(Gt,{title:"Painel Operacional",subtitle:"CRM Pastita",onMenuClick:()=>a(!0)}),e.jsx("main",{className:"flex-1 overflow-auto bg-gray-50 dark:bg-black",children:e.jsx("div",{className:"min-h-full",children:e.jsx(Ge,{})})})]})]})},Yt=s.createContext(null);function Zt({children:t,dashboardMode:a=!0}){const{token:r}=D(),{selectedAccount:o}=Z(),n=Y(),i=s.useRef(null),l=s.useRef(null),c=s.useRef(null),h=s.useRef(0),p=s.useRef(!1),j=s.useRef(new Set),[k,f]=s.useState(!1),[_,E]=s.useState(null),y=s.useCallback(()=>{if(!r)return null;let C;C||(C=window.location.host);const S=C.includes("localhost")||C.includes("127.0.0.1")?"ws":"wss";let z="/ws/whatsapp/dashboard/";return!a&&o&&(z=`/ws/whatsapp/${o.id}/`),`${S}://${C}${z}?token=${r}`},[r,a,o]),g=s.useCallback(()=>{l.current&&(clearTimeout(l.current),l.current=null),c.current&&(clearInterval(c.current),c.current=null),i.current&&(i.current.onclose=null,i.current.onerror=null,i.current.onmessage=null,i.current.close(),i.current=null)},[]),N=s.useCallback(C=>{try{const S=JSON.parse(C.data);switch(S.type){case"message_received":{const{message:z,conversation_id:L,contact:Fe}=S;if(L&&(n.addMessage(L,z),n.updateConversation({id:L,last_message_at:z.created_at,last_message_preview:z.text_body?.substring(0,50)||"MÃ­dia"}),n.selectedConversationId!==L)){n.incrementUnreadCount(L);const Ue=Fe?.name||z.from_number;ue(`Nova mensagem de ${Ue}`,{icon:"ðŸ’¬"})}break}case"message_sent":{const{message:z,conversation_id:L}=S;L&&(n.addMessage(L,z),n.updateConversation({id:L,last_message_at:z.created_at,last_message_preview:z.text_body?.substring(0,50)||"MÃ­dia"}));break}case"status_updated":{n.updateMessageStatus(S.message_id,S.status,S.timestamp);break}case"conversation_updated":{n.updateConversation(S.conversation);break}case"typing":break;case"error":{ue.error(`WhatsApp: ${S.error_message}`);break}case"connection_established":console.log("[WhatsAppWS] Connection established:",S.message);break;case"pong":break}}catch(S){console.error("[WhatsAppWS] Error parsing message:",S)}},[n]),v=s.useCallback(()=>{if(p.current||i.current?.readyState===WebSocket.OPEN)return;const C=y();if(!C){E("NÃ£o autenticado");return}p.current=!0,E(null);try{i.current=new WebSocket(C),i.current.onopen=()=>{console.log("[WhatsAppWS] Connected"),p.current=!1,h.current=0,f(!0),E(null),n.setWsConnected(!0),j.current.forEach(S=>{i.current?.send(JSON.stringify({type:"subscribe_conversation",conversation_id:S}))}),c.current=window.setInterval(()=>{i.current?.readyState===WebSocket.OPEN&&i.current.send(JSON.stringify({type:"ping"}))},3e4)},i.current.onmessage=N,i.current.onclose=S=>{if(console.log("[WhatsAppWS] Disconnected:",S.code,S.reason),p.current=!1,f(!1),n.setWsConnected(!1),c.current&&(clearInterval(c.current),c.current=null),S.code>=4e3&&S.code<5e3){E("ConexÃ£o recusada pelo servidor");return}const z=Math.min(1e3*Math.pow(2,h.current),3e4);h.current+=1,h.current<=10?(console.log(`[WhatsAppWS] Reconnecting in ${z}ms (attempt ${h.current})`),l.current=window.setTimeout(v,z)):E("Falha ao reconectar apÃ³s vÃ¡rias tentativas")},i.current.onerror=S=>{console.error("[WhatsAppWS] Error:",S),p.current=!1}}catch(S){console.error("[WhatsAppWS] Connection error:",S),p.current=!1,E("Erro ao conectar")}},[y,N,n]),P=s.useCallback(()=>{g(),h.current=0,v()},[g,v]),R=s.useCallback(C=>{j.current.add(C),i.current?.readyState===WebSocket.OPEN&&i.current.send(JSON.stringify({type:"subscribe_conversation",conversation_id:C}))},[]),d=s.useCallback(C=>{j.current.delete(C),i.current?.readyState===WebSocket.OPEN&&i.current.send(JSON.stringify({type:"unsubscribe_conversation",conversation_id:C}))},[]),x=s.useCallback((C,S)=>{i.current?.readyState===WebSocket.OPEN&&i.current.send(JSON.stringify({type:"typing",conversation_id:C,is_typing:S}))},[]),w=s.useRef(!1);s.useEffect(()=>(r&&!w.current&&(w.current=!0,v()),()=>{w.current=!1,g()}),[r]);const A=s.useRef(null);s.useEffect(()=>{if(!a&&o&&r){const C=o.id;A.current&&A.current!==C&&P(),A.current=C}},[a,o?.id,r]);const I={isConnected:k,connectionError:_,subscribeToConversation:R,unsubscribeFromConversation:d,sendTypingIndicator:x,reconnect:P};return e.jsx(Yt.Provider,{value:I,children:t})}const es=s.lazy(()=>b(()=>import("./LoginPage-C6CkGV-l.js"),__vite__mapDeps([0,1,2,3,4,5,6,7])).then(t=>({default:t.LoginPage}))),ts=s.lazy(()=>b(()=>import("./DashboardPage-CrK21Zu8.js"),__vite__mapDeps([8,1,2,3,4,5,6,7,9])).then(t=>({default:t.DashboardPage}))),ss=s.lazy(()=>b(()=>import("./AccountsPage-BFUXnc30.js"),__vite__mapDeps([10,1,2,3,4,5,6,7])).then(t=>({default:t.AccountsPage}))),je=s.lazy(()=>b(()=>import("./AccountFormPage-B5sP40Lb.js"),__vite__mapDeps([11,1,2,3,4,5,6,7])).then(t=>({default:t.AccountFormPage}))),rs=s.lazy(()=>b(()=>import("./AccountDetailPage-DsL0w641.js"),__vite__mapDeps([12,1,2,3,4,5,6,7])).then(t=>({default:t.AccountDetailPage}))),as=s.lazy(()=>b(()=>import("./MessagesPage-DtR4NwQo.js"),__vite__mapDeps([13,1,2,3,4,5,6,7,14])).then(t=>({default:t.MessagesPage}))),ns=s.lazy(()=>b(()=>import("./ConversationsPage-DhC0iEru.js"),__vite__mapDeps([15,1,2,3,4,5,6,7])).then(t=>({default:t.ConversationsPage}))),os=s.lazy(()=>b(()=>import("./OrdersPage-CeCaW_hW.js"),__vite__mapDeps([16,1,2,3,4,5,6,7])).then(t=>({default:t.OrdersPage}))),is=s.lazy(()=>b(()=>import("./OrderDetailPageNew-Id6N2ALC.js"),__vite__mapDeps([17,1,2,3,4,5,6,7])).then(t=>({default:t.OrderDetailPageNew}))),cs=s.lazy(()=>b(()=>import("./PaymentsPage-DqKSk0UQ.js"),__vite__mapDeps([18,1,2,3,4,5,6,7])).then(t=>({default:t.PaymentsPage}))),ls=s.lazy(()=>b(()=>import("./SettingsPage-mIo1q4J6.js"),__vite__mapDeps([19,1,2,3,4,5,6,7])).then(t=>({default:t.SettingsPage}))),ds=s.lazy(()=>b(()=>import("./index-CoMg742U.js"),__vite__mapDeps([20,1,2,3,4,5,6,7])).then(t=>({default:t.AgentsPage}))),ye=s.lazy(()=>b(()=>import("./index-CoMg742U.js"),__vite__mapDeps([20,1,2,3,4,5,6,7])).then(t=>({default:t.AgentDetailPage}))),us=s.lazy(()=>b(()=>import("./index-CoMg742U.js"),__vite__mapDeps([20,1,2,3,4,5,6,7])).then(t=>({default:t.AgentCreatePage}))),ms=s.lazy(()=>b(()=>import("./index-CoMg742U.js"),__vite__mapDeps([20,1,2,3,4,5,6,7])).then(t=>({default:t.AgentTestPage}))),hs=s.lazy(()=>b(()=>import("./index-CoMg742U.js"),__vite__mapDeps([20,1,2,3,4,5,6,7])).then(t=>({default:t.UnifiedOrchestratorTest}))),gs=s.lazy(()=>b(()=>import("./index-jrwLWn2F.js"),__vite__mapDeps([21,1,2,3,4,5,6,7])).then(t=>({default:t.CouponsPage}))),xs=s.lazy(()=>b(()=>import("./ProductsPageNew-D4kWTcK5.js"),__vite__mapDeps([22,1,2,3,4,5,6,7])).then(t=>({default:t.ProductsPageNew}))),ps=s.lazy(()=>b(()=>import("./feature-automation-CLWK1V5x.js").then(t=>t.bx),__vite__mapDeps([3,2,1,4,5,6,7])).then(t=>({default:t.CompanyProfilesPage}))),ve=s.lazy(()=>b(()=>import("./feature-automation-CLWK1V5x.js").then(t=>t.bx),__vite__mapDeps([3,2,1,4,5,6,7])).then(t=>({default:t.CompanyProfileDetailPage}))),fs=s.lazy(()=>b(()=>import("./feature-automation-CLWK1V5x.js").then(t=>t.bx),__vite__mapDeps([3,2,1,4,5,6,7])).then(t=>({default:t.AutoMessagesPage}))),bs=s.lazy(()=>b(()=>import("./feature-automation-CLWK1V5x.js").then(t=>t.bx),__vite__mapDeps([3,2,1,4,5,6,7])).then(t=>({default:t.CustomerSessionsPage}))),js=s.lazy(()=>b(()=>import("./feature-automation-CLWK1V5x.js").then(t=>t.bx),__vite__mapDeps([3,2,1,4,5,6,7])).then(t=>({default:t.AutomationLogsPage}))),ys=s.lazy(()=>b(()=>import("./feature-automation-CLWK1V5x.js").then(t=>t.bx),__vite__mapDeps([3,2,1,4,5,6,7])).then(t=>({default:t.ScheduledMessagesPage}))),vs=s.lazy(()=>b(()=>import("./feature-automation-CLWK1V5x.js").then(t=>t.bx),__vite__mapDeps([3,2,1,4,5,6,7])).then(t=>({default:t.ReportsPage}))),ke=s.lazy(()=>b(()=>import("./feature-automation-CLWK1V5x.js").then(t=>t.bx),__vite__mapDeps([3,2,1,4,5,6,7])).then(t=>({default:t.IntentStatsPage}))),ks=s.lazy(()=>b(()=>import("./feature-automation-CLWK1V5x.js").then(t=>t.bx),__vite__mapDeps([3,2,1,4,5,6,7])).then(t=>({default:t.IntentLogsPage}))),K=s.lazy(()=>b(()=>import("./feature-reports-B4FqePvs.js").then(t=>t.i),__vite__mapDeps([23,1,2,6,3,4,5,7])).then(t=>({default:t.AnalyticsPage}))),_s=s.lazy(()=>b(()=>import("./index-Bb3jCAeJ.js"),__vite__mapDeps([24,1,2,3,4,5,6,7])).then(t=>({default:t.StoresPage}))),ws=s.lazy(()=>b(()=>import("./index-Bb3jCAeJ.js"),__vite__mapDeps([24,1,2,3,4,5,6,7])).then(t=>({default:t.StoreDetailPage}))),Ss=s.lazy(()=>b(()=>import("./index-Bb3jCAeJ.js"),__vite__mapDeps([24,1,2,3,4,5,6,7])).then(t=>({default:t.StoreSettingsPage}))),_e=s.lazy(()=>b(()=>import("./index-37FIuZc9.js"),__vite__mapDeps([25,1,2,3,4,5,6,7,26])).then(t=>({default:t.MarketingPage}))),Cs=s.lazy(()=>b(()=>import("./index-37FIuZc9.js"),__vite__mapDeps([25,1,2,3,4,5,6,7,26])).then(t=>({default:t.SubscribersPage}))),Ns=s.lazy(()=>b(()=>import("./index-_OVmQ73D.js"),__vite__mapDeps([27,1,2,3,4,5,6,7,26])).then(t=>({default:t.NewCampaignPage}))),we=s.lazy(()=>b(()=>import("./index-_OVmQ73D.js"),__vite__mapDeps([27,1,2,3,4,5,6,7,26])).then(t=>({default:t.CampaignsListPage}))),Es=s.lazy(()=>b(()=>import("./index-DV_E1_V-.js"),__vite__mapDeps([28,1,2,3,4,5,6,7])).then(t=>({default:t.NewWhatsAppCampaignPage}))),Ps=s.lazy(()=>b(()=>import("./index-DV_E1_V-.js"),__vite__mapDeps([28,1,2,3,4,5,6,7])).then(t=>({default:t.WhatsAppCampaignsPage}))),As=s.lazy(()=>b(()=>import("./WhatsAppTemplatesPage-D0zb7TgF.js"),__vite__mapDeps([29,1,2,3,4,5,6,7])).then(t=>({default:t.default}))),zs=s.lazy(()=>b(()=>import("./AutomationsPage-B8qmZ2sa.js"),__vite__mapDeps([30,1,2,3,4,5,6,7,26])).then(t=>({default:t.default}))),Se=s.lazy(()=>b(()=>import("./index-DekSK43D.js"),__vite__mapDeps([31,1,2,3,4,5,6,7,9,23,32])).then(t=>({default:t.InstagramAccountsPage}))),Rs=s.lazy(()=>b(()=>import("./index-DekSK43D.js"),__vite__mapDeps([31,1,2,3,4,5,6,7,9,23,32])).then(t=>({default:t.InstagramDashboardPage}))),Is=s.lazy(()=>b(()=>import("./index-DekSK43D.js"),__vite__mapDeps([31,1,2,3,4,5,6,7,9,23,32])).then(t=>({default:t.InstagramInbox}))),Ce=s.lazy(()=>b(()=>import("./index-Ba2YuiBZ.js"),__vite__mapDeps([33,1,2,6,23,3,4,5,7,32])).then(t=>({default:t.MessengerInbox}))),Ls=s.lazy(()=>b(()=>import("./index-Ba2YuiBZ.js"),__vite__mapDeps([33,1,2,6,23,3,4,5,7,32])).then(t=>({default:t.MessengerAccounts}))),Ts=s.lazy(()=>b(()=>import("./index-D950XLqf.js"),__vite__mapDeps([34,1,2,3,4,5,6,7,14])).then(t=>({default:t.WebhookDiagnosticsPage}))),Os=s.lazy(()=>b(()=>import("./index-D950XLqf.js"),__vite__mapDeps([34,1,2,3,4,5,6,7,14])).then(t=>({default:t.WhatsAppChatPage}))),Ds=({children:t})=>{const{isAuthenticated:a}=D();return a?e.jsx(e.Fragment,{children:t}):e.jsx(Q,{to:"/login",replace:!0})},Ne=()=>{const{isAuthenticated:t,token:a}=D(),{setAccounts:r}=Z(),[o,n]=s.useState(!0);return s.useEffect(()=>{(async()=>{if(a&&Ie(a),t&&a)try{const l=await jt.getAccounts();r(l.results)}catch(l){W.error("Error loading accounts:",l)}n(!1)})()},[t,a,r]),o?e.jsx(m,{}):e.jsxs(Xe,{children:[e.jsx(u,{path:"/login",element:t?e.jsx(Q,{to:"/",replace:!0}):e.jsx(s.Suspense,{fallback:e.jsx(m,{}),children:e.jsx(es,{})})}),e.jsxs(u,{path:"/",element:e.jsx(Ds,{children:e.jsx(Xt,{})}),children:[e.jsx(u,{index:!0,element:e.jsx(s.Suspense,{fallback:e.jsx(m,{}),children:e.jsx(ts,{})})}),e.jsx(u,{path:"accounts",element:e.jsx(s.Suspense,{fallback:e.jsx(m,{}),children:e.jsx(ss,{})})}),e.jsx(u,{path:"accounts/new",element:e.jsx(s.Suspense,{fallback:e.jsx(m,{}),children:e.jsx(je,{})})}),e.jsx(u,{path:"accounts/:id",element:e.jsx(s.Suspense,{fallback:e.jsx(m,{}),children:e.jsx(rs,{})})}),e.jsx(u,{path:"accounts/:id/edit",element:e.jsx(s.Suspense,{fallback:e.jsx(m,{}),children:e.jsx(je,{})})}),e.jsx(u,{path:"messages",element:e.jsx(s.Suspense,{fallback:e.jsx(m,{}),children:e.jsx(as,{})})}),e.jsx(u,{path:"conversations",element:e.jsx(s.Suspense,{fallback:e.jsx(m,{}),children:e.jsx(ns,{})})}),e.jsx(u,{path:"agents",element:e.jsx(s.Suspense,{fallback:e.jsx(m,{}),children:e.jsx(ds,{})})}),e.jsx(u,{path:"agents/new",element:e.jsx(s.Suspense,{fallback:e.jsx(m,{}),children:e.jsx(us,{})})}),e.jsx(u,{path:"agents/:id",element:e.jsx(s.Suspense,{fallback:e.jsx(m,{}),children:e.jsx(ye,{})})}),e.jsx(u,{path:"agents/:id/test",element:e.jsx(s.Suspense,{fallback:e.jsx(m,{}),children:e.jsx(ms,{})})}),e.jsx(u,{path:"agents/:id/conversations",element:e.jsx(s.Suspense,{fallback:e.jsx(m,{}),children:e.jsx(ye,{})})}),e.jsx(u,{path:"agents/test/orchestrator",element:e.jsx(s.Suspense,{fallback:e.jsx(m,{}),children:e.jsx(hs,{})})}),e.jsx(u,{path:"settings",element:e.jsx(s.Suspense,{fallback:e.jsx(m,{}),children:e.jsx(ls,{})})}),e.jsx(u,{path:"automation/companies",element:e.jsx(s.Suspense,{fallback:e.jsx(m,{}),children:e.jsx(ps,{})})}),e.jsx(u,{path:"automation/companies/new",element:e.jsx(s.Suspense,{fallback:e.jsx(m,{}),children:e.jsx(ve,{})})}),e.jsx(u,{path:"automation/companies/:id",element:e.jsx(s.Suspense,{fallback:e.jsx(m,{}),children:e.jsx(ve,{})})}),e.jsx(u,{path:"automation/companies/:companyId/messages",element:e.jsx(s.Suspense,{fallback:e.jsx(m,{}),children:e.jsx(fs,{})})}),e.jsx(u,{path:"automation/sessions",element:e.jsx(s.Suspense,{fallback:e.jsx(m,{}),children:e.jsx(bs,{})})}),e.jsx(u,{path:"automation/logs",element:e.jsx(s.Suspense,{fallback:e.jsx(m,{}),children:e.jsx(js,{})})}),e.jsx(u,{path:"automation/scheduled",element:e.jsx(s.Suspense,{fallback:e.jsx(m,{}),children:e.jsx(ys,{})})}),e.jsx(u,{path:"automation/reports",element:e.jsx(s.Suspense,{fallback:e.jsx(m,{}),children:e.jsx(vs,{})})}),e.jsx(u,{path:"automation/intents",element:e.jsx(s.Suspense,{fallback:e.jsx(m,{}),children:e.jsx(ke,{})})}),e.jsx(u,{path:"automation/intents/stats",element:e.jsx(s.Suspense,{fallback:e.jsx(m,{}),children:e.jsx(ke,{})})}),e.jsx(u,{path:"automation/intents/logs",element:e.jsx(s.Suspense,{fallback:e.jsx(m,{}),children:e.jsx(ks,{})})}),e.jsx(u,{path:"analytics",element:e.jsx(s.Suspense,{fallback:e.jsx(m,{}),children:e.jsx(K,{})})}),e.jsx(u,{path:"reports",element:e.jsx(s.Suspense,{fallback:e.jsx(m,{}),children:e.jsx(K,{})})}),e.jsx(u,{path:"stores",element:e.jsx(s.Suspense,{fallback:e.jsx(m,{}),children:e.jsx(_s,{})})}),e.jsx(u,{path:"stores/:storeId",element:e.jsx(s.Suspense,{fallback:e.jsx(m,{}),children:e.jsx(ws,{})})}),e.jsx(u,{path:"stores/:storeId/products",element:e.jsx(s.Suspense,{fallback:e.jsx(m,{}),children:e.jsx(xs,{})})}),e.jsx(u,{path:"stores/:storeId/orders",element:e.jsx(s.Suspense,{fallback:e.jsx(m,{}),children:e.jsx(os,{})})}),e.jsx(u,{path:"stores/:storeId/orders/:id",element:e.jsx(s.Suspense,{fallback:e.jsx(m,{}),children:e.jsx(is,{})})}),e.jsx(u,{path:"stores/:storeId/coupons",element:e.jsx(s.Suspense,{fallback:e.jsx(m,{}),children:e.jsx(gs,{})})}),e.jsx(u,{path:"stores/:storeId/analytics",element:e.jsx(s.Suspense,{fallback:e.jsx(m,{}),children:e.jsx(K,{})})}),e.jsx(u,{path:"stores/:storeId/payments",element:e.jsx(s.Suspense,{fallback:e.jsx(m,{}),children:e.jsx(cs,{})})}),e.jsx(u,{path:"stores/:storeId/settings",element:e.jsx(s.Suspense,{fallback:e.jsx(m,{}),children:e.jsx(Ss,{})})}),e.jsx(u,{path:"marketing",element:e.jsx(s.Suspense,{fallback:e.jsx(m,{}),children:e.jsx(_e,{})})}),e.jsx(u,{path:"marketing/subscribers",element:e.jsx(s.Suspense,{fallback:e.jsx(m,{}),children:e.jsx(Cs,{})})}),e.jsx(u,{path:"marketing/automations",element:e.jsx(s.Suspense,{fallback:e.jsx(m,{}),children:e.jsx(zs,{})})}),e.jsx(u,{path:"marketing/email",element:e.jsx(s.Suspense,{fallback:e.jsx(m,{}),children:e.jsx(we,{})})}),e.jsx(u,{path:"marketing/email/campaigns",element:e.jsx(s.Suspense,{fallback:e.jsx(m,{}),children:e.jsx(we,{})})}),e.jsx(u,{path:"marketing/email/new",element:e.jsx(s.Suspense,{fallback:e.jsx(m,{}),children:e.jsx(Ns,{})})}),e.jsx(u,{path:"marketing/email/templates",element:e.jsx(s.Suspense,{fallback:e.jsx(m,{}),children:e.jsx(_e,{})})}),e.jsx(u,{path:"marketing/whatsapp",element:e.jsx(s.Suspense,{fallback:e.jsx(m,{}),children:e.jsx(Ps,{})})}),e.jsx(u,{path:"marketing/whatsapp/new",element:e.jsx(s.Suspense,{fallback:e.jsx(m,{}),children:e.jsx(Es,{})})}),e.jsx(u,{path:"marketing/whatsapp/templates",element:e.jsx(s.Suspense,{fallback:e.jsx(m,{}),children:e.jsx(As,{})})}),e.jsx(u,{path:"instagram",element:e.jsx(s.Suspense,{fallback:e.jsx(m,{}),children:e.jsx(Se,{})})}),e.jsx(u,{path:"instagram/accounts",element:e.jsx(s.Suspense,{fallback:e.jsx(m,{}),children:e.jsx(Se,{})})}),e.jsx(u,{path:"instagram/:accountId",element:e.jsx(s.Suspense,{fallback:e.jsx(m,{}),children:e.jsx(Rs,{})})}),e.jsx(u,{path:"instagram/inbox",element:e.jsx(s.Suspense,{fallback:e.jsx(m,{}),children:e.jsx(Is,{})})}),e.jsx(u,{path:"messenger",element:e.jsx(s.Suspense,{fallback:e.jsx(m,{}),children:e.jsx(Ce,{})})}),e.jsx(u,{path:"messenger/inbox",element:e.jsx(s.Suspense,{fallback:e.jsx(m,{}),children:e.jsx(Ce,{})})}),e.jsx(u,{path:"messenger/accounts",element:e.jsx(s.Suspense,{fallback:e.jsx(m,{}),children:e.jsx(Ls,{})})}),e.jsx(u,{path:"whatsapp/chat",element:e.jsx(s.Suspense,{fallback:e.jsx(m,{}),children:e.jsx(Os,{})})}),e.jsx(u,{path:"whatsapp/diagnostics",element:e.jsx(s.Suspense,{fallback:e.jsx(m,{}),children:e.jsx(Ts,{})})})]}),e.jsx(u,{path:"*",element:e.jsx(Q,{to:"/",replace:!0})})]})},Ws=()=>{const{isAuthenticated:t}=D();return t?e.jsx(Pt,{children:e.jsx(Zt,{dashboardMode:!0,children:e.jsx(Ne,{})})}):e.jsx(Ne,{})},Ee=t=>typeof t=="boolean"?`${t}`:t===0?"0":t,Pe=He,De=(t,a)=>r=>{var o;if(a?.variants==null)return Pe(t,r?.class,r?.className);const{variants:n,defaultVariants:i}=a,l=Object.keys(n).map(p=>{const j=r?.[p],k=i?.[p];if(j===null)return null;const f=Ee(j)||Ee(k);return n[p][f]}),c=r&&Object.entries(r).reduce((p,j)=>{let[k,f]=j;return f===void 0||(p[k]=f),p},{}),h=a==null||(o=a.compoundVariants)===null||o===void 0?void 0:o.reduce((p,j)=>{let{class:k,className:f,..._}=j;return Object.entries(_).every(E=>{let[y,g]=E;return Array.isArray(g)?g.includes({...i,...c}[y]):{...i,...c}[y]===g})?[...p,k,f]:p},[]);return Pe(t,l,h,r?.class,r?.className)},$s=De("inline-flex items-center justify-center gap-2 rounded-lg font-medium transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-offset-2 disabled:opacity-50 disabled:pointer-events-none active:scale-[0.98]",{variants:{variant:{primary:"bg-primary-600 text-white hover:bg-primary-700 focus:ring-primary-500 shadow-sm",secondary:"bg-zinc-100 text-zinc-900 hover:bg-zinc-200 focus:ring-zinc-500 dark:bg-zinc-800 dark:text-zinc-100 dark:hover:bg-zinc-700",outline:"border-2 border-primary-600 text-primary-600 hover:bg-primary-50 focus:ring-primary-500 dark:hover:bg-primary-900/20",ghost:"text-zinc-600 hover:bg-zinc-100 hover:text-zinc-900 focus:ring-zinc-500 dark:text-zinc-400 dark:hover:bg-zinc-800 dark:hover:text-zinc-100",danger:"bg-red-600 text-white hover:bg-red-700 focus:ring-red-500 shadow-sm",success:"bg-green-600 text-white hover:bg-green-700 focus:ring-green-500 shadow-sm",link:"text-primary-600 underline-offset-4 hover:underline focus:ring-primary-500 dark:text-primary-400"},size:{xs:"h-7 px-2 text-xs",sm:"h-8 px-3 text-sm",md:"h-10 px-4 text-sm",lg:"h-12 px-6 text-base",xl:"h-14 px-8 text-lg",icon:"h-10 w-10"},fullWidth:{true:"w-full"}},defaultVariants:{variant:"primary",size:"md"}}),X=O.forwardRef(({className:t,variant:a,size:r,fullWidth:o,loading:n,leftIcon:i,rightIcon:l,children:c,disabled:h,...p},j)=>e.jsx("button",{className:T($s({variant:a,size:r,fullWidth:o,className:t})),ref:j,disabled:h||n,...p,children:n?e.jsxs(e.Fragment,{children:[e.jsxs("svg",{className:"animate-spin h-4 w-4",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),c]}):e.jsxs(e.Fragment,{children:[i&&e.jsx("span",{className:"flex-shrink-0",children:i}),c,l&&e.jsx("span",{className:"flex-shrink-0",children:l})]})}));X.displayName="Button";const Ms=De("rounded-xl border bg-white text-zinc-950 shadow-sm dark:bg-zinc-950 dark:text-zinc-50",{variants:{variant:{default:"border-zinc-200 dark:border-zinc-800",outline:"border-2",ghost:"border-none shadow-none bg-transparent",elevated:"shadow-lg border-zinc-200 dark:border-zinc-800"},padding:{none:"",sm:"p-4",md:"p-6",lg:"p-8"}},defaultVariants:{variant:"default",padding:"md"}}),We=O.forwardRef(({className:t,variant:a,padding:r,...o},n)=>e.jsx("div",{ref:n,className:T(Ms({variant:a,padding:r,className:t})),...o}));We.displayName="Card";const $e=O.forwardRef(({className:t,...a},r)=>e.jsx("div",{ref:r,className:T("flex flex-col space-y-1.5",t),...a}));$e.displayName="CardHeader";const Me=O.forwardRef(({className:t,...a},r)=>e.jsx("h3",{ref:r,className:T("text-lg font-semibold leading-none tracking-tight",t),...a}));Me.displayName="CardTitle";const Vs=O.forwardRef(({className:t,...a},r)=>e.jsx("p",{ref:r,className:T("text-sm text-zinc-500 dark:text-zinc-400",t),...a}));Vs.displayName="CardDescription";const Ve=O.forwardRef(({className:t,...a},r)=>e.jsx("div",{ref:r,className:T("",t),...a}));Ve.displayName="CardContent";const Fs=O.forwardRef(({className:t,...a},r)=>e.jsx("div",{ref:r,className:T("flex items-center pt-4",t),...a}));Fs.displayName="CardFooter";class Us extends s.Component{constructor(){super(...arguments);F(this,"state",{hasError:!1,error:null,errorInfo:null});F(this,"handleReset",()=>{this.setState({hasError:!1,error:null,errorInfo:null}),window.location.reload()})}static getDerivedStateFromError(r){return{hasError:!0,error:r,errorInfo:null}}componentDidCatch(r,o){console.error("Uncaught error:",r,o),this.setState({error:r,errorInfo:o})}render(){return this.state.hasError?this.props.fallback?this.props.fallback:e.jsx("div",{className:"min-h-screen flex items-center justify-center p-4 bg-zinc-50 dark:bg-black",children:e.jsxs(We,{className:"max-w-lg w-full",children:[e.jsx($e,{children:e.jsx(Me,{className:"text-red-600 dark:text-red-400",children:"Algo deu errado"})}),e.jsxs(Ve,{className:"space-y-4",children:[e.jsx("p",{className:"text-zinc-600 dark:text-zinc-400",children:"Ocorreu um erro inesperado. Tente recarregar a pÃ¡gina."}),this.state.error&&e.jsx("div",{className:"bg-red-50 dark:bg-red-900/20 p-4 rounded-lg overflow-auto",children:e.jsx("p",{className:"text-sm font-mono text-red-800 dark:text-red-200",children:this.state.error.toString()})}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx(X,{onClick:this.handleReset,variant:"primary",children:"Recarregar pÃ¡gina"}),e.jsx(X,{onClick:()=>window.location.href="/",variant:"secondary",children:"Voltar ao inÃ­cio"})]})]})]})}):this.props.children}}try{if(typeof window<"u"){const t=window.localStorage.getItem("auth-storage");if(t){const r=JSON.parse(t)?.state?.token;r&&(Ie(r),console.debug("[main] preloaded auth header from localStorage"))}}}catch{}G.createRoot(document.getElementById("root")).render(e.jsx(O.StrictMode,{children:e.jsx(Us,{children:e.jsx(Ut,{children:e.jsxs(Ye,{children:[e.jsx(Ws,{}),e.jsx(yt,{position:"top-right",toastOptions:{className:"dark:bg-zinc-900 dark:text-white dark:border dark:border-zinc-800"}})]})})})}));export{b as _,At as a,Z as u};
