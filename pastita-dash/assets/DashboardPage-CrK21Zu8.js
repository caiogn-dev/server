import{j as e,L as j,D as v,b as E,d as M,e as B,P,f as H,g as O,p as I,h as T,i as Z,k as q}from"./vendor-charts-o9Lo7m6Z.js";import{r as d}from"./vendor-react-C2HNIXra.js";import{_ as y,l as f,$ as V,a0 as G,a1 as i,o as J,i as K,e as Q,a2 as U,w as W,q as X,a3 as Y,a4 as r,a5 as n,p as x}from"./feature-automation-CLWK1V5x.js";import{u as ee}from"./index-DQDVHdIA.js";import{u as N}from"./useFetch-DwL-vu9q.js";import{g}from"./vendor-utils-DaXQUBrP.js";import"./vendor-ui-B9rDAafI.js";import"./vendor-mui-DKuE-Kg_.js";E.register(M,B,P,H,O,I,T,Z,q);const ne=()=>{const{selectedAccount:c}=ee(),[l,w]=d.useState(7),k=d.useCallback(()=>y.getOverview(c?.id),[c?.id]),{data:a,loading:C,error:p}=N(k),_=d.useCallback(()=>y.getCharts(c?.id,l),[c?.id,l]),{data:t,loading:R,error:u}=N(_);if(d.useEffect(()=>{p&&f.error("Error loading dashboard overview",p)},[p]),d.useEffect(()=>{u&&f.error("Error loading dashboard charts",u)},[u]),C&&!a)return e.jsx(V,{});const A=[{value:"7",label:"Últimos 7 dias"},{value:"14",label:"Últimos 14 dias"},{value:"30",label:"Últimos 30 dias"},{value:"90",label:"Últimos 90 dias"}],m=l===1?"1 dia":`${l} dias`,o=R&&!t,D={labels:t?.messages_per_day?.map(s=>g(new Date(s.date),"dd/MM",{locale:x}))||[],datasets:[{label:"Recebidas",data:t?.messages_per_day?.map(s=>s.inbound)||[],borderColor:"#25D366",backgroundColor:"rgba(37, 211, 102, 0.1)",fill:!0,tension:.4},{label:"Enviadas",data:t?.messages_per_day?.map(s=>s.outbound)||[],borderColor:"#128C7E",backgroundColor:"rgba(18, 140, 126, 0.1)",fill:!0,tension:.4}]},F={labels:t?.orders_per_day?.map(s=>g(new Date(s.date),"dd/MM",{locale:x}))||[],datasets:[{label:"Pedidos",data:t?.orders_per_day?.map(s=>s.count)||[],borderColor:"#722F37",backgroundColor:"rgba(114, 47, 55, 0.15)",fill:!0,tension:.4,yAxisID:"y"},{label:"Receita (R$)",data:t?.orders_per_day?.map(s=>s.revenue)||[],borderColor:"#8B3A42",backgroundColor:"rgba(139, 58, 66, 0.12)",fill:!0,tension:.4,yAxisID:"y1"}]},$={labels:t?.conversations_per_day?.map(s=>g(new Date(s.date),"dd/MM",{locale:x}))||[],datasets:[{label:"Novas",data:t?.conversations_per_day?.map(s=>s.new)||[],borderColor:"#22C55E",backgroundColor:"rgba(34, 197, 94, 0.12)",fill:!0,tension:.4},{label:"Resolvidas",data:t?.conversations_per_day?.map(s=>s.resolved)||[],borderColor:"#14B8A6",backgroundColor:"rgba(20, 184, 166, 0.12)",fill:!0,tension:.4}]},b=Object.keys(t?.message_types||{}),L={text:"Texto",image:"Imagem",audio:"Áudio",video:"Vídeo",document:"Documento",sticker:"Sticker",location:"Localização",contact:"Contato"},S={labels:b.map(s=>L[s]||s.replace(/_/g," ")),datasets:[{data:b.map(s=>t?.message_types?.[s]||0),backgroundColor:["#34D399","#60A5FA","#FBBF24","#F472B6","#A78BFA","#F97316","#2DD4BF","#93C5FD"]}]},z={labels:Object.keys(t?.order_statuses||{}),datasets:[{data:Object.values(t?.order_statuses||{}),backgroundColor:["#FCD34D","#60A5FA","#F97316","#A78BFA","#34D399","#F472B6","#EF4444","#6B7280"]}]};return e.jsxs("div",{className:"p-4 md:p-6 space-y-4 md:space-y-6",children:[e.jsx(G,{title:"Dashboard",subtitle:`Última atualização: ${a?.timestamp?g(new Date(a.timestamp),"dd/MM/yyyy 'às' HH:mm",{locale:x}):"-"}`}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-3 md:gap-4",children:[e.jsx(i,{title:"Mensagens Hoje",value:a?.messages.today||0,icon:e.jsx(J,{className:"w-5 h-5 md:w-6 md:h-6"})}),e.jsx(i,{title:"Conversas Ativas",value:a?.conversations.active||0,icon:e.jsx(K,{className:"w-5 h-5 md:w-6 md:h-6"})}),e.jsx(i,{title:"Pedidos Hoje",value:a?.orders.today||0,icon:e.jsx(Q,{className:"w-5 h-5 md:w-6 md:h-6"})}),e.jsx(i,{title:"Receita Hoje",value:`R$ ${(a?.orders.revenue_today||0).toLocaleString("pt-BR",{minimumFractionDigits:2})}`,icon:e.jsx(U,{className:"w-5 h-5 md:w-6 md:h-6"})}),e.jsx(i,{title:"Interações IA",value:a?.agents?.interactions_today||0,icon:e.jsx(W,{className:"w-5 h-5 md:w-6 md:h-6"})}),e.jsx(i,{title:"Contas Ativas",value:a?.accounts.active||0,icon:e.jsx(X,{className:"w-5 h-5 md:w-6 md:h-6"})})]}),e.jsxs("div",{className:"flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-base md:text-lg font-semibold text-gray-900 dark:text-white dark:text-white",children:"Analytics detalhado"}),e.jsxs("p",{className:"text-xs md:text-sm text-gray-500 dark:text-zinc-400 dark:text-zinc-400",children:["Indicadores dos últimos ",m,"."]})]}),e.jsx("div",{className:"w-full sm:w-64",children:e.jsx(Y,{label:"Período",value:String(l),onChange:s=>w(Number(s.target.value)),options:A})})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsx(r,{title:`Mensagens (${m})`,className:"lg:col-span-2",children:e.jsx("div",{className:"h-80",children:o?e.jsx("div",{className:"h-full flex items-center justify-center",children:e.jsx(n,{size:"lg"})}):e.jsx(j,{data:D,options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"top"}},scales:{y:{beginAtZero:!0}}}})})}),e.jsx(r,{title:"Status dos Pedidos",children:e.jsx("div",{className:"h-80 flex items-center justify-center",children:o?e.jsx(n,{size:"lg"}):e.jsx(v,{data:z,options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"bottom"}}}})})})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsx(r,{title:`Pedidos e Receita (${m})`,className:"lg:col-span-2",children:e.jsx("div",{className:"h-80",children:o?e.jsx("div",{className:"h-full flex items-center justify-center",children:e.jsx(n,{size:"lg"})}):e.jsx(j,{data:F,options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"top"}},scales:{y:{beginAtZero:!0,title:{display:!0,text:"Pedidos"}},y1:{beginAtZero:!0,position:"right",grid:{drawOnChartArea:!1},ticks:{callback:s=>`R$ ${Number(s).toLocaleString("pt-BR")}`}}}}})})}),e.jsx(r,{title:"Tipos de Mensagem",children:e.jsx("div",{className:"h-80 flex items-center justify-center",children:o?e.jsx(n,{size:"lg"}):e.jsx(v,{data:S,options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"bottom"}}}})})})]}),e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:e.jsx(r,{title:`Conversas (${m})`,className:"lg:col-span-3",children:e.jsx("div",{className:"h-80",children:o?e.jsx("div",{className:"h-full flex items-center justify-center",children:e.jsx(n,{size:"lg"})}):e.jsx(j,{data:$,options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"top"}},scales:{y:{beginAtZero:!0}}}})})})}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsx(r,{title:"Mensagens por Status",children:e.jsx("div",{className:"space-y-3",children:Object.entries(a?.messages.by_status||{}).map(([s,h])=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600 dark:text-zinc-400 capitalize",children:s}),e.jsx("span",{className:"text-sm font-medium text-gray-900 dark:text-white",children:h})]},s))})}),e.jsx(r,{title:"Conversas por Modo",children:e.jsx("div",{className:"space-y-3",children:Object.entries(a?.conversations.by_mode||{}).map(([s,h])=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600 dark:text-zinc-400 capitalize",children:s==="auto"?"Automático":s==="human"?"Humano":"Híbrido"}),e.jsx("span",{className:"text-sm font-medium text-gray-900 dark:text-white",children:h})]},s))})}),e.jsx(r,{title:"Estatísticas Agentes IA",children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600 dark:text-zinc-400",children:"Interações Hoje"}),e.jsx("span",{className:"text-sm font-medium text-gray-900 dark:text-white",children:a?.agents?.interactions_today||0})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600 dark:text-zinc-400",children:"Tempo Médio"}),e.jsxs("span",{className:"text-sm font-medium text-gray-900 dark:text-white",children:[a?.agents?.avg_response_time_ms||0,"ms"]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600 dark:text-zinc-400",children:"Taxa de Sucesso"}),e.jsxs("span",{className:"text-sm font-medium text-green-600 dark:text-green-400",children:[a?.agents?.success_rate||0,"%"]})]})]})})]}),e.jsx(r,{title:"Resumo Financeiro",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[e.jsxs("div",{className:"text-center p-4 bg-green-50 dark:bg-green-900/30 rounded-lg border border-green-100 dark:border-green-800",children:[e.jsx("p",{className:"text-sm text-green-600 dark:text-green-400 font-medium",children:"Receita Hoje"}),e.jsxs("p",{className:"text-2xl font-bold text-green-700 dark:text-green-300 mt-1",children:["R$ ",(a?.orders.revenue_today||0).toLocaleString("pt-BR",{minimumFractionDigits:2})]})]}),e.jsxs("div",{className:"text-center p-4 bg-blue-50 dark:bg-blue-900/30 rounded-lg border border-blue-100 dark:border-blue-800",children:[e.jsx("p",{className:"text-sm text-blue-600 dark:text-blue-400 font-medium",children:"Receita do Mês"}),e.jsxs("p",{className:"text-2xl font-bold text-blue-700 dark:text-blue-300 mt-1",children:["R$ ",(a?.orders.revenue_month||0).toLocaleString("pt-BR",{minimumFractionDigits:2})]})]}),e.jsxs("div",{className:"text-center p-4 bg-yellow-50 dark:bg-yellow-900/30 rounded-lg border border-yellow-100 dark:border-yellow-800",children:[e.jsx("p",{className:"text-sm text-yellow-600 dark:text-yellow-400 font-medium",children:"Pagamentos Pendentes"}),e.jsx("p",{className:"text-2xl font-bold text-yellow-700 dark:text-yellow-300 mt-1",children:a?.payments.pending||0})]}),e.jsxs("div",{className:"text-center p-4 bg-purple-50 dark:bg-purple-900/30 rounded-lg border border-purple-100 dark:border-purple-800",children:[e.jsx("p",{className:"text-sm text-purple-600 dark:text-purple-400 font-medium",children:"Pagamentos Hoje"}),e.jsx("p",{className:"text-2xl font-bold text-purple-700 dark:text-purple-300 mt-1",children:a?.payments.completed_today||0})]})]})})]})};export{ne as DashboardPage};
