import{j as e}from"./vendor-charts-o9Lo7m6Z.js";import{e as K,r as o,u as Re,R as Ie}from"./vendor-react-C2HNIXra.js";import{bg as z,a5 as F,a4 as C,X as u,a6 as V,a1 as y,bh as P,ae as Q,af as ce,ba as U,b1 as _,aa as fe,aO as $e,ah as de,R as E,p as Me,bi as Le,aZ as ze,bj as xe,b4 as H,bk as Ae,aM as Ee,bl as je,bm as De,bn as Fe,bo as O,bp as N}from"./feature-automation-CLWK1V5x.js";import"./index-DQDVHdIA.js";import{u as B}from"./useFetch-DwL-vu9q.js";import{i as Be}from"./vendor-utils-DaXQUBrP.js";import{i as S,B as x,C as me,T as p,s as Te,c as ue,F as Pe,I as Oe,S as We,M as qe,t as W,v as he,w as Ve,x as Ue,h as q,y as He,z as Ge,E as Ke,H as Qe,D as Xe,k as pe,P as Ze,A as Je}from"./vendor-mui-DKuE-Kg_.js";import{r as k,d as Ye}from"./feature-reports-B4FqePvs.js";import{d as es,a as ss}from"./Search-BWkx6N48.js";import"./vendor-ui-B9rDAafI.js";const zs=()=>{const r=K(),[c,t]=o.useState(null),[l,n]=o.useState(null),[d,a]=o.useState(!1),R=o.useCallback(()=>z.list(),[]),{data:g,loading:w,error:j,refresh:v}=B(R),I=async i=>{t(i.id);try{await z.sync(i.id),E.success(`Conta @${i.username} sincronizada!`),v()}catch{E.error("Erro ao sincronizar conta")}finally{t(null)}},b=async()=>{if(l)try{await z.delete(l.id),E.success("Conta removida com sucesso"),v()}catch{E.error("Erro ao remover conta")}finally{n(null)}},$=()=>{const A=`https://www.facebook.com/v18.0/dialog/oauth?client_id=undefined&redirect_uri=${`${window.location.origin}/instagram/callback`}&scope=instagram_basic,instagram_content_publish,instagram_shopping_tag_product,pages_read_engagement&response_type=code`;window.open(A,"instagram_auth","width=600,height=700"),a(!1)};if(w)return e.jsx("div",{className:"p-6",children:e.jsx(F,{message:"Carregando contas..."})});if(j)return e.jsx("div",{className:"p-6",children:e.jsx(C,{children:e.jsxs("div",{className:"text-center py-8",children:[e.jsx("p",{className:"text-red-500 mb-4",children:"Erro ao carregar contas"}),e.jsx(u,{onClick:v,variant:"primary",children:"Tentar novamente"})]})})});const h=g?.filter(i=>i.is_active)||[],M=h.reduce((i,f)=>i+f.followers_count,0);return e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Instagram"}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"Gerencie contas, posts, stories e lives"})]}),e.jsx(u,{onClick:()=>a(!0),variant:"primary",leftIcon:e.jsx(V,{className:"w-5 h-5"}),children:"Conectar Conta"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsx(y,{title:"Contas Conectadas",value:h.length,icon:e.jsx(P,{className:"w-5 h-5"})}),e.jsx(y,{title:"Total de Seguidores",value:M.toLocaleString("pt-BR"),icon:e.jsx(Q,{className:"w-5 h-5"})}),e.jsx(y,{title:"Contas Verificadas",value:h.filter(i=>i.is_verified).length,icon:e.jsx(ce,{className:"w-5 h-5 text-blue-500"})}),e.jsx(y,{title:"MÃ­dias Totais",value:h.reduce((i,f)=>i+f.media_count,0).toLocaleString("pt-BR"),icon:e.jsx(U,{className:"w-5 h-5"})})]}),e.jsxs(C,{children:[e.jsx("div",{className:"p-4 border-b border-gray-200 dark:border-gray-700",children:e.jsx("h2",{className:"text-lg font-semibold",children:"Contas Conectadas"})}),!g||g.length===0?e.jsxs("div",{className:"p-8 text-center",children:[e.jsx(P,{className:"w-16 h-16 mx-auto text-gray-400 mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-2",children:"Nenhuma conta conectada"}),e.jsx("p",{className:"text-gray-500 mb-4",children:"Conecte sua conta do Instagram para comeÃ§ar"}),e.jsx(u,{onClick:()=>a(!0),variant:"primary",leftIcon:e.jsx(V,{className:"w-5 h-5"}),children:"Conectar Instagram"})]}):e.jsx("div",{className:"divide-y divide-gray-200 dark:divide-gray-700",children:g.map(i=>e.jsx("div",{className:"p-4 hover:bg-gray-50 dark:hover:bg-gray-800 transition-colors",children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"flex-shrink-0",children:i.profile_picture_url?e.jsx("img",{src:i.profile_picture_url,alt:i.username,className:"w-16 h-16 rounded-full object-cover"}):e.jsx("div",{className:"w-16 h-16 rounded-full bg-gradient-to-br from-purple-500 to-pink-500 flex items-center justify-center",children:e.jsx("span",{className:"text-2xl text-white font-bold",children:i.username[0].toUpperCase()})})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:["@",i.username]}),i.is_verified&&e.jsx(ce,{className:"w-5 h-5 text-blue-500"}),!i.is_active&&e.jsx(_,{variant:"danger",children:"Inativa"})]}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400 text-sm mt-1 line-clamp-2",children:i.biography||"Sem biografia"}),e.jsxs("div",{className:"flex flex-wrap gap-4 mt-3 text-sm",children:[e.jsxs("span",{className:"text-gray-600 dark:text-gray-400",children:[e.jsx("strong",{className:"text-gray-900 dark:text-white",children:i.followers_count.toLocaleString("pt-BR")})," ","seguidores"]}),e.jsxs("span",{className:"text-gray-600 dark:text-gray-400",children:[e.jsx("strong",{className:"text-gray-900 dark:text-white",children:i.follows_count.toLocaleString("pt-BR")})," ","seguindo"]}),e.jsxs("span",{className:"text-gray-600 dark:text-gray-400",children:[e.jsx("strong",{className:"text-gray-900 dark:text-white",children:i.media_count.toLocaleString("pt-BR")})," ","publicaÃ§Ãµes"]})]}),i.last_sync_at&&e.jsxs("p",{className:"text-xs text-gray-400 mt-2",children:["Sincronizado"," ",Be(new Date(i.last_sync_at),{addSuffix:!0,locale:Me})]})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx(u,{onClick:()=>r(`/instagram/${i.id}`),variant:"secondary",size:"sm",leftIcon:e.jsx(U,{className:"w-4 h-4"}),children:"Ver"}),e.jsx(u,{onClick:()=>I(i),variant:"secondary",size:"sm",isLoading:c===i.id,leftIcon:e.jsx(fe,{className:"w-4 h-4"}),children:"Sincronizar"}),e.jsx(u,{onClick:()=>n(i),variant:"danger",size:"sm",leftIcon:e.jsx($e,{className:"w-4 h-4"}),children:"Remover"})]})]})},i.id))})]}),e.jsx(de,{isOpen:d,onClose:()=>a(!1),title:"Conectar Conta do Instagram",size:"md",children:e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-20 h-20 mx-auto mb-4 rounded-2xl bg-gradient-to-br from-purple-500 via-pink-500 to-orange-400 flex items-center justify-center",children:e.jsx(P,{className:"w-10 h-10 text-white"})}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Conectar Instagram"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-6",children:"VocÃª serÃ¡ redirecionado para o Facebook para autorizar o acesso Ã  sua conta do Instagram."}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(u,{onClick:$,variant:"primary",className:"w-full",children:"Continuar com Facebook"}),e.jsx(u,{onClick:()=>a(!1),variant:"ghost",className:"w-full",children:"Cancelar"})]})]})})}),e.jsx(de,{isOpen:!!l,onClose:()=>n(null),title:"Remover Conta",size:"sm",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("p",{className:"text-gray-600 dark:text-gray-400 mb-6",children:["Tem certeza que deseja remover a conta"," ",e.jsxs("strong",{children:["@",l?.username]}),"? Esta aÃ§Ã£o nÃ£o pode ser desfeita."]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx(u,{onClick:()=>n(null),variant:"ghost",className:"flex-1",children:"Cancelar"}),e.jsx(u,{onClick:b,variant:"danger",className:"flex-1",children:"Remover"})]})]})})]})},As=()=>{const{accountId:r}=Re(),c=K(),[t,l]=o.useState("feed"),[n,d]=o.useState(!1),{data:a,loading:R}=B(()=>z.get(r)),g=async()=>{if(!r)return[];switch(t){case"feed":return O.getFeed();case"stories":return O.getStories();case"reels":return O.getReels();default:return[]}},{data:w,loading:j,refresh:v}=B(g),I=()=>{c(`/instagram/${r}/create`,{state:{mediaType:t==="reels"?"REELS":"IMAGE"}})},b=()=>{c(`/instagram/${r}/schedule`)};if(R)return e.jsx("div",{className:"p-6",children:e.jsx(F,{message:"Carregando conta..."})});if(!a)return e.jsx("div",{className:"p-6",children:e.jsx(C,{children:e.jsxs("div",{className:"text-center py-8",children:[e.jsx("p",{className:"text-gray-500",children:"Conta nÃ£o encontrada"}),e.jsx(u,{onClick:()=>c("/instagram"),variant:"primary",className:"mt-4",children:"Voltar para Contas"})]})})});const $=[{id:"feed",label:"Feed",icon:H},{id:"stories",label:"Stories",icon:Ae},{id:"reels",label:"Reels",icon:Ee},{id:"insights",label:"EstatÃ­sticas",icon:Q}];return e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs(C,{className:"overflow-hidden",children:[e.jsx("div",{className:"bg-gradient-to-r from-purple-600 via-pink-500 to-orange-400 p-6",children:e.jsxs("div",{className:"flex flex-col md:flex-row items-center gap-6",children:[e.jsxs("div",{className:"relative",children:[a.profile_picture_url?e.jsx("img",{src:a.profile_picture_url,alt:a.username,className:"w-24 h-24 rounded-full border-4 border-white shadow-lg object-cover"}):e.jsx("div",{className:"w-24 h-24 rounded-full border-4 border-white shadow-lg bg-gradient-to-br from-purple-400 to-pink-400 flex items-center justify-center",children:e.jsx("span",{className:"text-3xl text-white font-bold",children:a.username[0].toUpperCase()})}),a.is_verified&&e.jsx("div",{className:"absolute -bottom-1 -right-1 w-8 h-8 bg-blue-500 rounded-full flex items-center justify-center border-2 border-white",children:e.jsx("svg",{className:"w-5 h-5 text-white",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})})]}),e.jsxs("div",{className:"text-center md:text-left text-white",children:[e.jsxs("h1",{className:"text-2xl font-bold",children:["@",a.username]}),e.jsx("p",{className:"mt-1 opacity-90",children:a.biography||"Sem biografia"}),e.jsxs("div",{className:"flex flex-wrap justify-center md:justify-start gap-6 mt-4",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-2xl font-bold",children:a.media_count.toLocaleString("pt-BR")}),e.jsx("span",{className:"block text-sm opacity-80",children:"publicaÃ§Ãµes"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-2xl font-bold",children:a.followers_count.toLocaleString("pt-BR")}),e.jsx("span",{className:"block text-sm opacity-80",children:"seguidores"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-2xl font-bold",children:a.follows_count.toLocaleString("pt-BR")}),e.jsx("span",{className:"block text-sm opacity-80",children:"seguindo"})]})]})]}),e.jsxs("div",{className:"flex flex-wrap justify-center gap-3",children:[e.jsx(u,{onClick:()=>c(`/instagram/${r}/live`),variant:"secondary",className:"bg-white/20 backdrop-blur-sm text-white border-white/30 hover:bg-white/30",leftIcon:e.jsx(Le,{className:"w-5 h-5"}),children:"Live"}),e.jsx(u,{onClick:()=>c(`/instagram/${r}/shopping`),variant:"secondary",className:"bg-white/20 backdrop-blur-sm text-white border-white/30 hover:bg-white/30",leftIcon:e.jsx(ze,{className:"w-5 h-5"}),children:"Shopping"}),e.jsx(u,{onClick:()=>c(`/instagram/${r}/schedule`),variant:"secondary",className:"bg-white/20 backdrop-blur-sm text-white border-white/30 hover:bg-white/30",leftIcon:e.jsx(xe,{className:"w-5 h-5"}),children:"Agendar"})]})]})}),e.jsx("div",{className:"border-b border-gray-200 dark:border-gray-700",children:e.jsx("nav",{className:"flex -mb-px",children:$.map(h=>e.jsxs("button",{onClick:()=>l(h.id),className:`
                  flex items-center gap-2 px-6 py-4 text-sm font-medium border-b-2 transition-colors
                  ${t===h.id?"border-pink-500 text-pink-600 dark:text-pink-400":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}
                `,children:[e.jsx(h.icon,{className:"w-5 h-5"}),h.label]},h.id))})})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("h2",{className:"text-xl font-semibold",children:[t==="feed"&&"Feed de Posts",t==="stories"&&"Stories",t==="reels"&&"Reels",t==="insights"&&"EstatÃ­sticas"]}),t!=="insights"&&e.jsxs("div",{className:"flex gap-3",children:[e.jsx(u,{onClick:b,variant:"secondary",leftIcon:e.jsx(xe,{className:"w-5 h-5"}),children:"Agendar"}),e.jsxs(u,{onClick:I,variant:"primary",leftIcon:e.jsx(V,{className:"w-5 h-5"}),children:["Criar ",t==="stories"?"Story":t==="reels"?"Reel":"Post"]})]})]}),j?e.jsx(F,{message:"Carregando..."}):t==="insights"?e.jsx(ts,{accountId:r}):e.jsx(as,{media:w||[],type:t,onRefresh:v})]})},as=({media:r,type:c,onRefresh:t})=>{const l=K();return r.length===0?e.jsx(C,{children:e.jsxs("div",{className:"p-12 text-center",children:[e.jsx(H,{className:"w-16 h-16 mx-auto text-gray-400 mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-2",children:"Nenhuma mÃ­dia encontrada"}),e.jsxs("p",{className:"text-gray-500 mb-4",children:[c==="stories"&&"VocÃª ainda nÃ£o tem stories publicados",c==="reels"&&"VocÃª ainda nÃ£o tem reels publicados",c==="feed"&&"VocÃª ainda nÃ£o tem posts no feed"]}),e.jsxs(u,{onClick:t,variant:"secondary",children:[e.jsx(fe,{className:"w-5 h-5 mr-2"}),"Atualizar"]})]})}):e.jsx("div",{className:`
      grid gap-4
      ${c==="stories"?"grid-cols-3 sm:grid-cols-4 md:grid-cols-6 lg:grid-cols-8":"grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4"}
    `,children:r.map(n=>e.jsxs("div",{onClick:()=>l(`/instagram/media/${n.id}`),className:"group relative aspect-square bg-gray-100 dark:bg-gray-800 rounded-lg overflow-hidden cursor-pointer",children:[n.thumbnail_url||n.media_url?e.jsx("img",{src:n.thumbnail_url||n.media_url,alt:n.caption||"MÃ­dia",className:"w-full h-full object-cover group-hover:scale-105 transition-transform"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center",children:e.jsx(H,{className:"w-12 h-12 text-gray-400"})}),e.jsx("div",{className:"absolute inset-0 bg-black/50 opacity-0 group-hover:opacity-100 transition-opacity flex flex-col items-center justify-center text-white",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(je,{className:"w-5 h-5"}),n.likes_count]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(Fe,{className:"w-5 h-5"}),n.comments_count]})]})}),e.jsxs("div",{className:"absolute top-2 left-2 flex gap-1",children:[n.media_type==="CAROUSEL_ALBUM"&&e.jsx(_,{variant:"secondary",className:"bg-black/50 text-white",children:"ðŸ“Ž"}),n.media_type==="VIDEO"&&e.jsx(_,{variant:"secondary",className:"bg-black/50 text-white",children:"â–¶ï¸"}),n.media_type==="REELS"&&e.jsx(_,{variant:"secondary",className:"bg-black/50 text-white",children:"ðŸŽ¬"})]}),e.jsxs("div",{className:"absolute top-2 right-2",children:[n.status==="SCHEDULED"&&e.jsx(_,{variant:"warning",children:"â° Agendado"}),n.status==="DRAFT"&&e.jsx(_,{variant:"secondary",children:"ðŸ“ Rascunho"})]}),c==="feed"&&n.caption&&e.jsx("div",{className:"absolute bottom-0 left-0 right-0 p-2 bg-gradient-to-t from-black/70 to-transparent",children:e.jsx("p",{className:"text-white text-xs line-clamp-2",children:n.caption})})]},n.id))})},ts=({accountId:r})=>{const[c,t]=o.useState(30),{data:l,loading:n}=B(()=>z.getInsights(r,c));return n?e.jsx(F,{}):e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex justify-end",children:e.jsxs("select",{value:c,onChange:d=>t(Number(d.target.value)),className:"px-4 py-2 border border-gray-300 rounded-lg",children:[e.jsx("option",{value:7,children:"Ãšltimos 7 dias"}),e.jsx("option",{value:30,children:"Ãšltimos 30 dias"}),e.jsx("option",{value:90,children:"Ãšltimos 90 dias"})]})}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsx(y,{title:"Alcance",value:l?.reduce((d,a)=>d+a.reach,0).toLocaleString("pt-BR")||"0",icon:e.jsx(U,{className:"w-5 h-5"})}),e.jsx(y,{title:"ImpressÃµes",value:l?.reduce((d,a)=>d+a.impressions,0).toLocaleString("pt-BR")||"0",icon:e.jsx(Q,{className:"w-5 h-5"})}),e.jsx(y,{title:"Engajamento",value:l?.reduce((d,a)=>d+a.engagement,0).toLocaleString("pt-BR")||"0",icon:e.jsx(je,{className:"w-5 h-5"})}),e.jsx(y,{title:"Novos Seguidores",value:l?.reduce((d,a)=>d+a.followers_gained,0).toLocaleString("pt-BR")||"0",icon:e.jsx(De,{className:"w-5 h-5"})})]}),e.jsx(C,{children:e.jsxs("div",{className:"p-6",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"VisÃ£o Geral"}),e.jsx("div",{className:"h-64 bg-gray-100 dark:bg-gray-800 rounded-lg flex items-center justify-center",children:e.jsx("p",{className:"text-gray-500",children:"GrÃ¡fico de desempenho (implementar com Chart.js)"})})]})})]})};var X={},rs=S;Object.defineProperty(X,"__esModule",{value:!0});var D=X.default=void 0;ls(o);var is=rs(k()),ns=e;function ve(r){if(typeof WeakMap!="function")return null;var c=new WeakMap,t=new WeakMap;return(ve=function(l){return l?t:c})(r)}function ls(r,c){if(r&&r.__esModule)return r;if(r===null||typeof r!="object"&&typeof r!="function")return{default:r};var t=ve(c);if(t&&t.has(r))return t.get(r);var l={__proto__:null},n=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var d in r)if(d!=="default"&&Object.prototype.hasOwnProperty.call(r,d)){var a=n?Object.getOwnPropertyDescriptor(r,d):null;a&&(a.get||a.set)?Object.defineProperty(l,d,a):l[d]=r[d]}return l.default=r,t&&t.set(r,l),l}D=X.default=(0,is.default)((0,ns.jsx)("path",{d:"M7.8 2h8.4C19.4 2 22 4.6 22 7.8v8.4a5.8 5.8 0 0 1-5.8 5.8H7.8C4.6 22 2 19.4 2 16.2V7.8A5.8 5.8 0 0 1 7.8 2m-.2 2A3.6 3.6 0 0 0 4 7.6v8.8C4 18.39 5.61 20 7.6 20h8.8a3.6 3.6 0 0 0 3.6-3.6V7.6C20 5.61 18.39 4 16.4 4H7.6m9.65 1.5a1.25 1.25 0 0 1 1.25 1.25A1.25 1.25 0 0 1 17.25 8 1.25 1.25 0 0 1 16 6.75a1.25 1.25 0 0 1 1.25-1.25M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3z"}),"Instagram");var Z={},os=S;Object.defineProperty(Z,"__esModule",{value:!0});var ye=Z.default=void 0,cs=os(k()),ds=e;ye=Z.default=(0,cs.default)((0,ds.jsx)("path",{d:"M21 19V5c0-1.1-.9-2-2-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2M8.5 13.5l2.5 3.01L14.5 12l4.5 6H5z"}),"Image");var J={},xs=S;Object.defineProperty(J,"__esModule",{value:!0});var be=J.default=void 0,ms=xs(k()),us=e;be=J.default=(0,ms.default)((0,us.jsx)("path",{d:"M12 2C6.47 2 2 6.47 2 12s4.47 10 10 10 10-4.47 10-10S17.53 2 12 2"}),"Circle");var Y={},hs=S;Object.defineProperty(Y,"__esModule",{value:!0});var we=Y.default=void 0,ps=hs(k()),ge=e;we=Y.default=(0,ps.default)([(0,ge.jsx)("path",{d:"M11.99 2C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2M12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8"},"0"),(0,ge.jsx)("path",{d:"M12.5 7H11v6l5.25 3.15.75-1.23-4.5-2.67z"},"1")],"AccessTime");var ee={},gs=S;Object.defineProperty(ee,"__esModule",{value:!0});var Ne=ee.default=void 0,fs=gs(k()),js=e;Ne=ee.default=(0,fs.default)((0,js.jsx)("path",{d:"M9 16.2 4.8 12l-1.4 1.4L9 19 21 7l-1.4-1.4z"}),"Done");var se={},vs=S;Object.defineProperty(se,"__esModule",{value:!0});var G=se.default=void 0,ys=vs(k()),bs=e;G=se.default=(0,ys.default)((0,bs.jsx)("path",{d:"m18 7-1.41-1.41-6.34 6.34 1.41 1.41zm4.24-1.41L11.66 16.17 7.48 12l-1.41 1.41L11.66 19l12-12zM.41 13.41 6 19l1.41-1.41L1.83 12z"}),"DoneAll");const ws={pending:e.jsx(we,{fontSize:"inherit",sx:{color:"text.disabled"}}),sent:e.jsx(Ne,{fontSize:"inherit",sx:{color:"text.disabled"}}),delivered:e.jsx(G,{fontSize:"inherit",sx:{color:"text.disabled"}}),seen:e.jsx(G,{fontSize:"inherit",sx:{color:"primary.main"}}),failed:e.jsx(be,{fontSize:"inherit",sx:{color:"error.main"}})};function Es(){const[r,c]=o.useState([]),[t,l]=o.useState(""),[n,d]=o.useState([]),[a,R]=o.useState(null),[g,w]=o.useState([]),[j,v]=o.useState(""),[I,b]=o.useState(!0),[$,h]=o.useState(!1),[M,i]=o.useState(!1),[f,ae]=o.useState(""),[A,L]=o.useState(null),te=o.useRef(null);o.useEffect(()=>{Ce()},[]),o.useEffect(()=>{t&&re()},[t]),o.useEffect(()=>{a&&Se()},[a]),o.useEffect(()=>{_e()},[g]);const _e=()=>{te.current?.scrollIntoView({behavior:"smooth"})},Ce=async()=>{try{const m=(await N.getAccounts()).data?.results||[];c(m),m.length>0&&l(m[0].id)}catch(s){console.error("Error loading accounts:",s),L("Erro ao carregar contas")}finally{b(!1)}},re=async()=>{if(t)try{b(!0);const s=await N.getConversations({account_id:t});d(s.data?.results||[]),L(null)}catch(s){console.error("Error loading conversations:",s),L("Erro ao carregar conversas")}finally{b(!1)}},Se=async()=>{if(a)try{h(!0);const m=(await N.getMessages({conversation_id:a.id})).data?.results||[];w(m.reverse()),t&&a.participant_id&&await N.markSeen(t,a.participant_id)}catch(s){console.error("Error loading messages:",s)}finally{h(!1)}},ie=async()=>{if(!(!j.trim()||!a||!t))try{i(!0);try{await N.sendTyping(t,a.participant_id)}catch{}const m=(await N.sendMessage({account_id:t,recipient_id:a.participant_id,text:j.trim()})).data;m&&w(oe=>[...oe,m]),v("")}catch(s){console.error("Error sending message:",s),L("Erro ao enviar mensagem")}finally{i(!1)}},ne=n.filter(s=>{if(!f)return!0;const m=f.toLowerCase();return s.participant_username?.toLowerCase().includes(m)||s.participant_name?.toLowerCase().includes(m)||s.last_message_preview?.toLowerCase().includes(m)}),le=s=>{if(!s)return"";const m=new Date(s),T=Math.floor((new Date().getTime()-m.getTime())/(1e3*60*60*24));return T===0?m.toLocaleTimeString("pt-BR",{hour:"2-digit",minute:"2-digit"}):T===1?"Ontem":T<7?m.toLocaleDateString("pt-BR",{weekday:"short"}):m.toLocaleDateString("pt-BR",{day:"2-digit",month:"2-digit"})},ke=s=>s&&ws[s]||null;return e.jsxs(x,{sx:{display:"flex",height:"calc(100vh - 100px)",gap:2,p:2},children:[e.jsxs(me,{sx:{width:360,display:"flex",flexDirection:"column"},children:[e.jsxs(x,{sx:{p:2,borderBottom:1,borderColor:"divider"},children:[e.jsxs(x,{display:"flex",alignItems:"center",gap:2,mb:2,children:[e.jsx(D,{sx:{color:"#E4405F",fontSize:28}}),e.jsx(p,{variant:"h6",fontWeight:"bold",children:"Instagram DM"}),e.jsx(x,{flex:1}),e.jsx(Te,{title:"Atualizar",children:e.jsx(ue,{size:"small",onClick:re,children:e.jsx(Ye,{})})})]}),r.length>1&&e.jsxs(Pe,{fullWidth:!0,size:"small",sx:{mb:2},children:[e.jsx(Oe,{children:"Conta"}),e.jsx(We,{value:t,label:"Conta",onChange:s=>l(s.target.value),children:r.map(s=>e.jsx(qe,{value:s.id,children:e.jsxs(x,{display:"flex",alignItems:"center",gap:1,children:[e.jsx(W,{src:s.profile_picture_url,sx:{width:24,height:24}}),"@",s.username]})},s.id))})]}),e.jsx(he,{fullWidth:!0,size:"small",placeholder:"Buscar conversas...",value:f,onChange:s=>ae(s.target.value),InputProps:{startAdornment:e.jsx(Ve,{position:"start",children:e.jsx(es,{fontSize:"small"})})}})]}),e.jsx(Ue,{sx:{flex:1,overflow:"auto",py:0},children:I?e.jsx(x,{display:"flex",justifyContent:"center",py:4,children:e.jsx(q,{})}):ne.length===0?e.jsxs(x,{textAlign:"center",py:4,px:2,children:[e.jsx(D,{sx:{fontSize:48,color:"text.disabled",mb:1}}),e.jsx(p,{color:"text.secondary",children:f?"Nenhuma conversa encontrada":"Nenhuma conversa ainda"})]}):ne.map(s=>e.jsxs(Ie.Fragment,{children:[e.jsxs(He,{selected:a?.id===s.id,onClick:()=>R(s),sx:{py:1.5},children:[e.jsx(Ge,{children:e.jsx(Ke,{badgeContent:s.unread_count,color:"error",overlap:"circular",children:e.jsx(W,{src:s.participant_profile_pic,children:s.participant_username?.[0]?.toUpperCase()||"U"})})}),e.jsx(Qe,{primary:e.jsxs(x,{display:"flex",justifyContent:"space-between",alignItems:"center",children:[e.jsxs(p,{variant:"body2",fontWeight:s.unread_count>0?"bold":"normal",noWrap:!0,children:["@",s.participant_username||s.participant_id]}),e.jsx(p,{variant:"caption",color:"text.secondary",children:le(s.last_message_at)})]}),secondary:e.jsx(p,{variant:"caption",color:s.unread_count>0?"text.primary":"text.secondary",fontWeight:s.unread_count>0?500:400,noWrap:!0,children:s.last_message_preview||"Nenhuma mensagem"})})]}),e.jsx(Xe,{component:"li"})]},s.id))})]}),e.jsx(me,{sx:{flex:1,display:"flex",flexDirection:"column"},children:a?e.jsxs(e.Fragment,{children:[e.jsxs(x,{sx:{p:2,borderBottom:1,borderColor:"divider",display:"flex",alignItems:"center",gap:2},children:[e.jsx(W,{src:a.participant_profile_pic,sx:{width:48,height:48},children:a.participant_username?.[0]?.toUpperCase()}),e.jsxs(x,{flex:1,children:[e.jsx(p,{variant:"subtitle1",fontWeight:"bold",children:a.participant_name||`@${a.participant_username}`}),e.jsxs(p,{variant:"caption",color:"text.secondary",children:["@",a.participant_username||a.participant_id]})]}),e.jsx(pe,{label:a.status==="active"?"Ativo":"Fechado",color:a.status==="active"?"success":"default",size:"small"})]}),e.jsxs(x,{sx:{flex:1,overflow:"auto",p:2,display:"flex",flexDirection:"column",gap:1,bgcolor:"grey.50"},children:[$?e.jsx(x,{display:"flex",justifyContent:"center",py:4,children:e.jsx(q,{})}):g.length===0?e.jsx(x,{textAlign:"center",py:4,children:e.jsx(p,{color:"text.secondary",children:"Nenhuma mensagem ainda. Envie a primeira!"})}):g.map(s=>e.jsx(x,{sx:{display:"flex",justifyContent:s.direction==="outbound"?"flex-end":"flex-start"},children:e.jsxs(Ze,{sx:{p:1.5,maxWidth:"70%",bgcolor:s.direction==="outbound"?"primary.main":"white",color:s.direction==="outbound"?"white":"text.primary",borderRadius:2,borderTopRightRadius:s.direction==="outbound"?0:2,borderTopLeftRadius:s.direction==="inbound"?0:2},children:[s.media_url&&e.jsx(x,{mb:1,children:s.message_type==="image"?e.jsx("img",{src:s.media_url,alt:"Imagem",style:{maxWidth:"100%",borderRadius:8}}):s.message_type==="video"?e.jsx("video",{src:s.media_url,controls:!0,style:{maxWidth:"100%",borderRadius:8}}):e.jsx(pe,{icon:e.jsx(ye,{}),label:s.message_type,size:"small"})}),s.text_content&&e.jsx(p,{variant:"body2",children:s.text_content}),e.jsxs(x,{display:"flex",justifyContent:"flex-end",alignItems:"center",gap:.5,mt:.5,children:[e.jsx(p,{variant:"caption",sx:{opacity:.7,fontSize:"0.65rem"},children:le(s.created_at)}),s.direction==="outbound"&&e.jsx(x,{sx:{fontSize:"0.8rem",display:"flex"},children:ke(s.status)})]})]})},s.id)),e.jsx("div",{ref:te})]}),e.jsxs(x,{sx:{p:2,borderTop:1,borderColor:"divider",display:"flex",gap:1},children:[e.jsx(he,{fullWidth:!0,placeholder:"Digite uma mensagem...",value:j,onChange:s=>v(s.target.value),onKeyPress:s=>{s.key==="Enter"&&!s.shiftKey&&(s.preventDefault(),ie())},multiline:!0,maxRows:4,disabled:M}),e.jsx(ue,{color:"primary",onClick:ie,disabled:!j.trim()||M,sx:{bgcolor:"primary.main",color:"white","&:hover":{bgcolor:"primary.dark"},"&:disabled":{bgcolor:"grey.300"}},children:M?e.jsx(q,{size:24,color:"inherit"}):e.jsx(ss,{})})]})]}):e.jsxs(x,{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",flex:1,color:"text.secondary",children:[e.jsx(D,{sx:{fontSize:80,color:"#E4405F",opacity:.5,mb:2}}),e.jsx(p,{variant:"h6",children:"Selecione uma conversa"}),e.jsx(p,{variant:"body2",children:"Escolha uma conversa da lista para ver as mensagens"})]})}),A&&e.jsx(Je,{severity:"error",sx:{position:"fixed",bottom:16,right:16},onClose:()=>L(null),children:A})]})}export{zs as InstagramAccountsPage,As as InstagramDashboardPage,Es as InstagramInbox};
